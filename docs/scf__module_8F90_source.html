<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: src/scf_module.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">scf_module.F90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="scf__module_8F90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">! This file is part of xtb.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">! Copyright (C) 2017-2020 Stefan Grimme</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">! xtb is free software: you can redistribute it and/or modify it under</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">! the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">! the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">! (at your option) any later version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">! xtb is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">! but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">! GNU Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">! You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">! along with xtb.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="namespacextb__scf.html">   18</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespacextb__scf.html">xtb_scf</a></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__mctc__accuracy.html">xtb_mctc_accuracy</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__mctc__convert.html">xtb_mctc_convert</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacextb__mctc__convert.html#a251a6230289b71aefe9a11d7df95213a">autoev</a>,<a class="code" href="namespacextb__mctc__convert.html#acdf2e027ee943efa9cc9a6b4701e3810">evtoau</a></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__mctc__blas.html">xtb_mctc_blas</a>, <span class="keywordtype">only</span> : mctc_gemv</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__mctc__lapack__eigensolve.html">xtb_mctc_lapack_eigensolve</a>, <span class="keywordtype">only</span> : <a class="code" href="structxtb__mctc__lapack__eigensolve_1_1teigensolver.html">teigensolver</a>, <a class="code" href="interfacextb__mctc__lapack__eigensolve_1_1init.html">init</a></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__coulomb__klopmanohno.html">xtb_coulomb_klopmanohno</a></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__disp__coordinationnumber.html">xtb_disp_coordinationnumber</a>, <span class="keywordtype">only</span> : <a class="code" href="interfacextb__disp__coordinationnumber_1_1getcoordinationnumber.html">getcoordinationnumber</a>, <a class="code" href="namespacextb__disp__coordinationnumber.html#ac64182ab5b87c4aeaae673862b4dd968">cntype</a></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__disp__dftd3.html">xtb_disp_dftd3</a>, <span class="keywordtype">only</span> : <a class="code" href="interfacextb__disp__dftd3_1_1d3__gradient.html">d3_gradient</a></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__solv__cm5.html">xtb_solv_cm5</a></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__solv__gbsa.html">xtb_solv_gbsa</a>, <span class="keywordtype">only</span> : <a class="code" href="structxtb__solv__gbsa_1_1tborn.html">tborn</a></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__basisset.html">xtb_type_basisset</a></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__coulomb.html">xtb_type_coulomb</a>, <span class="keywordtype">only</span> : <a class="code" href="structxtb__type__coulomb_1_1tcoulomb.html">tcoulomb</a></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__data.html">xtb_type_data</a></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__environment.html">xtb_type_environment</a></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__latticepoint.html">xtb_type_latticepoint</a>, <span class="keywordtype">only</span> : <a class="code" href="structxtb__type__latticepoint_1_1tlatticepoint.html">tlatticepoint</a>, <a class="code" href="interfacextb__mctc__lapack__eigensolve_1_1init.html">init</a></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__molecule.html">xtb_type_molecule</a>, <span class="keywordtype">only</span> : <a class="code" href="structxtb__type__molecule_1_1tmolecule.html">tmolecule</a></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__solvation.html">xtb_type_solvation</a>, <span class="keywordtype">only</span> : <a class="code" href="structxtb__type__solvation_1_1tsolvation.html">tsolvation</a></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__param.html">xtb_type_param</a></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__pcem.html">xtb_type_pcem</a></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__timer.html">xtb_type_timer</a></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__type__wavefunction.html">xtb_type_wavefunction</a></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__xtb__data.html">xtb_xtb_data</a></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__xtb__halogen.html">xtb_xtb_halogen</a></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__xtb__repulsion.html">xtb_xtb_repulsion</a></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__xtb__coulomb.html">xtb_xtb_coulomb</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__xtb__dispersion.html">xtb_xtb_dispersion</a></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__xtb__hamiltonian.html">xtb_xtb_hamiltonian</a>, <span class="keywordtype">only</span> : <a class="code" href="interfacextb__xtb__hamiltonian_1_1getselfenergy.html">getselfenergy</a>, <a class="code" href="namespacextb__xtb__hamiltonian.html#a9f0d8be35a4ef0f2dbbbafd2ef873d64">build_sdqh0</a>, <a class="code" href="namespacextb__xtb__hamiltonian.html#a8364d9293f8dac8d5de89c5186f7effc">build_dsdqh0</a>, &amp;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      &amp; <a class="code" href="namespacextb__xtb__hamiltonian.html#a299eaa3877160d0aff3f63dc55b12fde">build_dsdqh0_noreset</a>, <a class="code" href="namespacextb__xtb__hamiltonian.html#a452ff391a1572caaeec2ca34bca16bc8">count_dpint</a>, <a class="code" href="namespacextb__xtb__hamiltonian.html#acea5bedffd7dfd433b664c7729cdd3b2">count_qpint</a></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__xtb__hamiltonian__gpu.html">xtb_xtb_hamiltonian_gpu</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacextb__xtb__hamiltonian__gpu.html#aee3ffc022ae0b9686cef17ce77e6b117">build_sdqh0_gpu</a>, <a class="code" href="namespacextb__xtb__hamiltonian__gpu.html#a3fc32a40afb82002170a6633d8870ddb">build_dsdqh0_gpu</a></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__xtb__multipole.html">xtb_xtb_multipole</a></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__paramset.html">xtb_paramset</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacextb__paramset.html#a778d90934065b54ef79ded14000a3c6b">tmmetal</a></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__scc__core.html">xtb_scc_core</a></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__grad__core.html">xtb_grad_core</a></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__hlex.html">xtb_hlex</a></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__local.html">xtb_local</a></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__dipole.html">xtb_dipole</a></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordtype">private</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordtype">public</span> :: <a class="code" href="namespacextb__scf.html#a7390c40a38032c3d210c39edecfa49ed">scf</a></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">   60</a></span>&#160;   <span class="keywordtype">logical</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a> = .<a class="code" href="symmetry__i_8c.html#aa77c823a9fc018ae1d437369708d8727">true</a>.</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="namespacextb__scf.html#ae43d4d3c9f62b90fd69aa04258b534d2">   62</a></span>&#160;   <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacextb__grad__core.html#aa81adbbc26b2bb71b10652fad6c0b442">mmm</a>(20)=(/1,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4/)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="namespacextb__scf.html#afe99c4bdc76f3ccf7baa013bb17b05ac">   64</a></span>&#160;   <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespacextb__scf.html#afe99c4bdc76f3ccf7baa013bb17b05ac">metal</a>(1:86) = [&amp;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      &amp; 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, &amp;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      &amp; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, &amp;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      &amp; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, &amp;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      &amp; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &amp;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      &amp; 1, 0, 0, 0, 0, 0]</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">contains</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="namespacextb__scf.html#a7390c40a38032c3d210c39edecfa49ed">   73</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="namespacextb__scf.html#a7390c40a38032c3d210c39edecfa49ed">scf</a>(env, mol, wfn, basis, pcem, xtbData, solvation, &amp;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      &amp; egap, et, maxiter, prlevel, restart, grd, acc, energy, gradient, res)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!  global storage</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__setparam.html">xtb_setparam</a></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__aespot.html">xtb_aespot</a>,    <span class="keywordtype">only</span> : <a class="code" href="namespacextb__aespot.html#ad7ff96626bb3f99be059df5ec72f84f3">setdqlist</a>,<a class="code" href="namespacextb__aespot.html#adeab7e550551ee5a20061468ec1d9f04">get_radcn</a>,<a class="code" href="namespacextb__aespot.html#a49b3c4b26cb3479c91a54e16ca8dc168">setvsdq</a>, &amp;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   &amp;                     <a class="code" href="namespacextb__aespot.html#adda1948962d4d0d8b9f83f097cc915af">mmomgabzero</a>,<a class="code" href="namespacextb__aespot.html#ac7317133fd3c2f90fe508fb06e7acc7a">mmompop</a>,<a class="code" href="namespacextb__aespot.html#ab545f9823d314fe301898e447c29e9d0">molmom</a></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__disp__dftd4.html">xtb_disp_dftd4</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacextb__disp__dftd4.html#ae9b8a103199085161e97465354cf2e59">build_wdispmat</a>,<a class="code" href="namespacextb__disp__dftd4.html#acccc2e9773d4bfb42ab140832703d93d">d4dim</a>,<a class="code" href="namespacextb__disp__dftd4.html#a8a9a42ff62b20e292e8807b9cfcfb6c0">d4</a>,<a class="code" href="namespacextb__disp__dftd4.html#ab5c7be6d2c0d30018b8fc446f517b527">disppot</a>,p_refq_gfn2xtb, &amp;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   &amp;                     <a class="code" href="namespacextb__disp__dftd4.html#ad5d82a54f14bb80d751e8cd5b805900f">mdisp</a>,<a class="code" href="namespacextb__disp__dftd4.html#a2d6ceb85bc38753b6b2b82465a0a99b7">prmolc6</a>,<a class="code" href="namespacextb__disp__dftd4.html#a885a7392a062b6c1231b6f6d5cc14bb7">edisp_scc</a>,<a class="code" href="interfacextb__disp__dftd4_1_1d4__gradient.html">d4_gradient</a></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__disp__ncoord.html">xtb_disp_ncoord</a>,    <span class="keywordtype">only</span> : <a class="code" href="namespacextb__disp__ncoord.html#ad4ff09ec5e463a106638e914996b381c">dncoord_gfn</a>,<a class="code" href="namespacextb__disp__ncoord.html#af0b7bd632f8b73879b2a5626d4cb3bf1">ncoord_d4</a>,<a class="code" href="namespacextb__disp__ncoord.html#a5eb6e31ff90fa87ffedc75b984dc982f">dncoord_d3</a></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__embedding.html">xtb_embedding</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacextb__embedding.html#af628c36bfe42493ab8e772f39b4559c4">read_pcem</a>,<a class="code" href="namespacextb__embedding.html#a22c5a1934d3f04d2bc6d7eba340194c2">jpot_pcem_gfn1</a>,<a class="code" href="namespacextb__embedding.html#a7645c382151a4818907659d7d1cedce0">jpot_pcem_gfn2</a></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__aespot.html">xtb_aespot</a>,    <span class="keywordtype">only</span> : <a class="code" href="namespacextb__aespot.html#ada4b51d45f3c4e52276d0d8619ebc5e9">dradcn</a>,<a class="code" href="namespacextb__aespot.html#aab7af529842cf50edec5a2df03b28042">aniso_grad</a>,<a class="code" href="namespacextb__aespot.html#a06cbb099be359bfaf05f04c3b6488275">setdvsdq</a>,<a class="code" href="namespacextb__aespot.html#aa4d2436b7234ef3194dfff0592b1ed7c">dsint</a></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__disp__ncoord.html">xtb_disp_ncoord</a>,    <span class="keywordtype">only</span> : <a class="code" href="namespacextb__disp__ncoord.html#ad4ff09ec5e463a106638e914996b381c">dncoord_gfn</a>,<a class="code" href="namespacextb__disp__ncoord.html#a5eb6e31ff90fa87ffedc75b984dc982f">dncoord_d3</a></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__embedding.html">xtb_embedding</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacextb__embedding.html#a4263d2b3a7715ad81f6d2eb124f6cbf4">pcem_grad_gfn1</a>,<a class="code" href="namespacextb__embedding.html#afb99088275fac655b0730d04664b4fcd">pcem_grad_gfn2</a></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="keywordtype">use </span><a class="code" href="namespacextb__readin.html">xtb_readin</a></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">parameter</span> :: source = <span class="stringliteral">&#39;scf&#39;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__type__environment_1_1tenvironment.html">tenvironment</a>), <span class="keywordtype">intent(inout)</span>    :: env</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__type__molecule_1_1tmolecule.html">tmolecule</a>), <span class="keywordtype">intent(in)</span> :: mol</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__type__wavefunction_1_1twavefunction.html">twavefunction</a>),<span class="keywordtype">intent(inout)</span> :: wfn</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__type__basisset_1_1tbasisset.html">tbasisset</a>),<span class="keywordtype">intent(in)</span> :: basis</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__type__pcem_1_1tb__pcem.html">tb_pcem</a>),<span class="keywordtype">intent(inout)</span> :: pcem</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">intent(inout)</span> :: egap</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">intent(in)</span>    :: et</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>    :: maxiter</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>    :: prlevel</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>    :: restart</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span>    :: grd</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">intent(in)</span>    :: acc</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">intent(inout)</span> :: energy</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">intent(inout)</span> :: gradient(3,mol%n)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: sigma(3,3)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__type__data_1_1scc__results.html">scc_results</a>),<span class="keywordtype">intent(out)</span> :: res</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__xtb__data_1_1txtbdata.html">txtbdata</a>), <span class="keywordtype">intent(in)</span> :: xtbdata</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordtype">class</span>(<a class="code" href="structxtb__type__solvation_1_1tsolvation.html">tsolvation</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">intent(inout)</span> :: solvation</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__type__latticepoint_1_1tlatticepoint.html">tlatticepoint</a>) :: latp</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__mctc__lapack__eigensolve_1_1teigensolver.html">teigensolver</a>) :: solver</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: cn(:)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: x(:,:)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: s(:,:)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: s12(:,:)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: h0(:)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: ves(:) <span class="comment">! shell ES potential</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: vs(:)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: vd(:, :)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: vq(:, :)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: dhdcn(:)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: tmp(:)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: zsh(:)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: qq(:)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: qlmom(:,:)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: cm5(:)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: xcao(:,:)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: selfenergy(:, :)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: dsedcn(:, :)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: shellshift(:, :)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: temp(:)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: pew(:, :)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: h(:, :)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordtype">integer</span> :: nid</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: idnum(:)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__xtb__coulomb_1_1txtbcoulomb.html">txtbcoulomb</a>) :: ies</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__coulomb__klopmanohno_1_1tklopmanohno.html">tklopmanohno</a>) :: coulomb</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>), <span class="keywordtype">allocatable</span> :: djdr(:, :, :)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>), <span class="keywordtype">allocatable</span> :: djdtr(:, :)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>), <span class="keywordtype">allocatable</span> :: djdl(:, :, :)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">!  AES stuff</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__xtb__multipole_1_1txtbmultipole.html">txtbmultipole</a>), <span class="keywordtype">allocatable</span> :: aes</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span>  :: dpint(:,:,:),qpint(:,:,:)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span>  :: radcn(:) <span class="comment">! CBNEW</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__xtb__dispersion_1_1txtbdispersion.html">txtbdispersion</a>), <span class="keywordtype">allocatable</span> :: scd4</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: embd</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="keywordtype">integer</span>  :: mbd</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   parameter(mbd=3)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: molc6,molc8,molpol</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: aw(:,:)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: c6ab(:,:)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: rvol(:)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="keywordtype">integer</span>,<span class="keywordtype">allocatable</span> :: mdlst(:,:),mqlst(:,:)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordtype">integer</span> :: ndp,nqp</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="keywordtype">integer</span>,<span class="keywordtype">allocatable</span> :: matlist (:,:)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="keywordtype">integer</span>,<span class="keywordtype">allocatable</span> :: matlist2(:,:)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="keywordtype">integer</span>,<span class="keywordtype">allocatable</span> :: xblist(:,:)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: sqrab(:)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: dcndr(:,:,:)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: dcndl(:,:,:)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: trans(:,:)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: dipol(3),dip,gsolv,eat,hlgap,efix</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: xsum,eh1,rab,eold,dum,xx,r2</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: t0,t1,sum,rr,hav,alpha,ep,dx,dy,dz,dum1,r0i,r0j</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: efa,efb,nfoda,nfodb,hdii,hdjj,qconv,ff</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: x1,x2,ed,intcut,neglect,ga,gb,ehb,h0s,hmat,rab2</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: h0sr,scfconv,rmsq,dum2,drfdxyz(3),yy,tex,rav,tab,ljexp</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: ees,xa,xb,ya,yb,za,zb,repab,jmpol,kdampxb,vvxb,exb</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: w2,xj,gi,gj,eatoms,neglect2</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: w0,w1,damp,damp0,gtmp(3),exc</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: esave,eel</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: eaes,t6,t7,pi,epol,kexpe</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   parameter(pi =  3.14159265358979_wp)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">!  some parameter defaults which are not fitted</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keyword">data</span> ljexp/12.0_wp/ <span class="comment">! XB parameter for damped LJ in GFN1</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="keywordtype">integer</span> :: ich <span class="comment">! file handle</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keywordtype">integer</span> :: npr,ii,jj,kk,i,j,k,m,iat,jat,mi,jter,atj,kkk,mj,mm</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordtype">integer</span> :: ishell,jshell,np,ia,ndimv,l,nmat,nmat2</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <span class="keywordtype">integer</span> :: ll,i1,i2,nn,ati,nxb,<a class="code" href="constrain__pot_8f90.html#ac62613d43f31c7bfa652ee80083b400b">lin</a>,startpdiag</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="keywordtype">integer</span> :: is,js,gav</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <span class="keywordtype">character(len=128)</span> :: atmp,ftmp</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <span class="keywordtype">logical</span> :: ex,minpr,pr,fulldiag,lastdiag,iniqsh,fail</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">!  GBSA stuff</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: gborn,ghb,gsasa,gshift</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">!  for the CM5 charges</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: cm5a(:)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: dcm5a(:,:,:)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">!  point charge embedding stuff</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="keywordtype">logical</span>  :: lpcem</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>),<span class="keywordtype">allocatable</span> :: vpc(:)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keywordtype">   real</span>(<a class="code" href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">wp</a>) :: epcem</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="keywordtype">type</span>(<a class="code" href="structxtb__type__timer_1_1tb__timer.html">tb_timer</a>) :: <a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: scifmt = &amp;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="stringliteral">&#39;(10x,&quot;:&quot;,2x,a,e22.7,1x,a,1x,&quot;:&quot;)&#39;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: dblfmt = &amp;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="stringliteral">&#39;(10x,&quot;:&quot;,2x,a,f18.7,5x,a,1x,&quot;:&quot;)&#39;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: intfmt = &amp;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="stringliteral">&#39;(10x,&quot;:&quot;,2x,a,i18,      10x,&quot;:&quot;)&#39;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <span class="keywordtype">character(len=*)</span>,<span class="keywordtype">parameter</span> :: chrfmt = &amp;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="stringliteral">&#39;(10x,&quot;:&quot;,2x,a,a18,      10x,&quot;:&quot;)&#39;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="keywordtype">logical</span> :: exitrun</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">!  broyden stuff</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <span class="keywordtype">logical</span>  :: broy</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">!  initialization</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%new(7,.false.)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(1,<span class="stringliteral">&quot;SCC setup&quot;</span>)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   rmsq  =1.e+42_wp</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   lastdiag=.false.</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   lpcem = pcem%n &gt; 0</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   jter=0</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   dipol= 0.0_wp</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   eaes = 0.0_wp</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   gsolv= 0.0_wp</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   epol = 0.0_wp</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   ees  = 0.0_wp</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   epcem= 0.0_wp</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   ga   = 0.0_wp</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   gb   = 0.0_wp</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   eel  = 0.0_wp</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   ep   = 0.0_wp</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   ed   = 0.0_wp</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   embd = 0.0_wp</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   eat  = 0.0_wp</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   egap = 0.0_wp</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   molpol = 0.0_wp</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   pr   = prlevel.gt.1</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   minpr= prlevel.gt.0</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">!  numerical stuff</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">!  primitive cut-off</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   intcut=25.0_wp-10.0*log10(acc)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   intcut=max(20.0_wp,intcut)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">!  integral neglect threshold (the distance criterion used in ovlp limits S to about &gt;1.d-9</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   neglect =10.0d-9*acc</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   neglect2=neglect*10.0_wp</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">!  exit if E &lt; scfconv, Hessian sensitive to this</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   scfconv=1.d-6*acc</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">!  old/new q mixing start</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   damp0=0.20</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">!  conv threshold in dRMS q</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   qconv=2.d-5*acc</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="keywordflow">if</span>(<span class="keyword">allocated</span>(xtbdata%multipole)) qconv=1.d-4*acc</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   broy = mol%n &gt; 1</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">!  when to start pseudodiag (=1 after one full diag)</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   startpdiag=1000 <span class="comment">!large number=never</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">!  do the first SCC by full diag</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <span class="keywordflow">if</span>(egap.eq.0) startpdiag=1000</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keyword">call </span><a class="code" href="interfacextb__mctc__lapack__eigensolve_1_1init.html">init</a>(latp, env, mol, 60.0_wp)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">!ccccccccccccccccccc</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">! note: H is in eV!</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">!ccccccccccccccccccc</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <span class="keyword">call </span><a class="code" href="namespacextb__scc__core.html#a59b1e6be65cf0c0bf82cae50bf40000c">qsh2qat</a>(basis%ash,wfn%qsh,wfn%q)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">!  # atom arrays</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="keyword">allocate</span>(qq(mol%n),qlmom(3,mol%n),cm5(mol%n),sqrab(mol%n*(mol%n+1)/2))</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="keyword">allocate</span>(dcndr(3,mol%n,mol%n),cn(mol%n),dcndl(3,3,mol%n))</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">!  initialize the GBSA module (GBSA works with CM5 charges)</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(solvation)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span> (mol%npbc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         <span class="keyword">call </span>env%error(<span class="stringliteral">&quot;Solvation not available with PBC&quot;</span>, source)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;         <span class="keywordflow">return</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keyword">call </span>solvation%update(env, mol%at, mol%xyz)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keyword">allocate</span>(cm5a(mol%n),dcm5a(3,mol%n,mol%n))</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      gborn=0._wp</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      gsasa=0._wp</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      ghb=0._wp</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      gshift=0._wp</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      qq=0._wp</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">! initialize the CM5 charges computation</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      cm5=wfn%q</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      cm5a=0.d0</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      dcm5a=0.d0</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">if</span>(xtbdata%level == 1) <span class="keywordflow">then</span> <span class="comment">! only GFN1 does use CM5 charges</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;         <span class="keywordflow">select type</span>(solvation)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keywordflow">         type is</span> (<a class="code" href="structxtb__solv__gbsa_1_1tborn.html">tborn</a>)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keyword">call </span><a class="code" href="namespacextb__solv__cm5.html#a248c448671b487e7115213f001579585">calc_cm5</a>(mol%n,mol%at,mol%xyz,cm5a,dcm5a)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            cm5 = wfn%q + cm5a</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">         end select</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="keyword">allocate</span>(h0(basis%nao*(basis%nao+1)/2), &amp;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   &amp;        s(basis%nao,basis%nao),tmp(basis%nao), &amp;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   &amp;        x(basis%nao,basis%nao), &amp;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   &amp;        ves(basis%nshell), &amp;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   &amp;        zsh(basis%nshell),&amp;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   &amp;        matlist(2,basis%nao*(basis%nao+1)/2), &amp;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   &amp;        matlist2(2,basis%nao*(basis%nao+1)/2-basis%nao))</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   <span class="keyword">allocate</span>(selfenergy(maxval(xtbdata%nshell), mol%n))</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   <span class="keyword">allocate</span>(dsedcn(maxval(xtbdata%nshell), mol%n))</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="keyword">call </span><a class="code" href="namespacextb__scc__core.html#a83c6524ce5e445bf77857b79c238a8ff">setzshell</a>(xtbdata,mol%n,mol%at,basis%nshell,mol%z,zsh,eatoms,xtbdata%level)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <span class="comment">! fill levels</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   <span class="keywordflow">if</span>(wfn%nel.ne.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__scc__core.html#aac06c643c8cf37ba0337ace78508ab19">occu</a>(basis%nao,wfn%nel,wfn%nopen,wfn%ihomoa,wfn%ihomob,wfn%focca,wfn%foccb)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      wfn%focc = wfn%focca + wfn%foccb</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      wfn%ihomo=wfn%ihomoa</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      wfn%focc=0.0_wp</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      wfn%ihomo=0</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      wfn%ihomoa=0</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      wfn%nopen=0</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">!  distances and XB set</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   nxb = 0</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   k = 0</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <span class="keywordflow">do</span> i=1,mol%n</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">do</span> j=1,i</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">!        save distances</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;         k=k+1</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;         sqrab(k)=(mol%xyz(1,i)-mol%xyz(1,j))**2 &amp;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;         &amp;       +(mol%xyz(2,i)-mol%xyz(2,j))**2 &amp;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;         &amp;       +(mol%xyz(3,i)-mol%xyz(3,j))**2</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">!        XB</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="namespacextb__scf.html#afbb45fadd33b4d004619a75ddf69e0f9">xbond</a>(mol%at(i),mol%at(j)).and.sqrab(k).lt.400.) nxb=nxb+1</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordflow">   enddo</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="comment">! XB part</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <span class="keywordflow">if</span>(<span class="keyword">allocated</span>(xtbdata%halogen)) <span class="keywordflow">then</span> <span class="comment">! not used in GFN2</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keyword">allocate</span>(xblist(3,nxb+1))</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      nxb = 0</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      k = 0</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">do</span> i=1,mol%n</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;         ati=mol%at(i)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;         <span class="keywordflow">do</span> j=1,i</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            atj=mol%at(j)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            k=k+1</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="namespacextb__scf.html#afbb45fadd33b4d004619a75ddf69e0f9">xbond</a>(ati,atj).and.sqrab(k).lt.400) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;               nxb=nxb+1</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;               dum1=1.d+42</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;               <span class="keywordflow">if</span>(ati.eq.17.or.ati.eq.35.or.ati.eq.53.or.ati.eq.85)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                  xblist(1,nxb)=i</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                  xblist(2,nxb)=j</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                  <span class="keywordflow">do</span> m=1,mol%n</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                     <span class="keywordflow">if</span>(m.ne.i.and.sqrab(<a class="code" href="constrain__pot_8f90.html#ac62613d43f31c7bfa652ee80083b400b">lin</a>(m,i)).lt.dum1)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        dum1=sqrab(<a class="code" href="constrain__pot_8f90.html#ac62613d43f31c7bfa652ee80083b400b">lin</a>(m,i))</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                        xblist(3,nxb)=m</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keywordflow">                  enddo</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;               <span class="keywordflow">if</span>(atj.eq.17.or.atj.eq.35.or.atj.eq.53.or.atj.eq.85)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                  xblist(1,nxb)=j</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                  xblist(2,nxb)=i</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                  <span class="keywordflow">do</span> m=1,mol%n</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                     <span class="keywordflow">if</span>(m.ne.j.and.sqrab(<a class="code" href="constrain__pot_8f90.html#ac62613d43f31c7bfa652ee80083b400b">lin</a>(m,j)).lt.dum1)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                        dum1=sqrab(<a class="code" href="constrain__pot_8f90.html#ac62613d43f31c7bfa652ee80083b400b">lin</a>(m,j))</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                        xblist(3,nxb)=m</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordflow">                  enddo</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="keywordflow">         enddo</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="comment">! setup isotropic electrostatics</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keyword">call </span><a class="code" href="interfacextb__mctc__lapack__eigensolve_1_1init.html">init</a>(ies, xtbdata%coulomb, xtbdata%nshell, mol%at)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   nid = maxval(mol%id)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="keyword">allocate</span>(idnum(nid))</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keywordflow">do</span> ii = 1, nid</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      jat = 0</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">do</span> iat = 1, mol%n</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <span class="keywordflow">if</span> (mol%id(iat) == ii) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            jat = iat</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      idnum(ii) = mol%at(jat)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordflow">   end do</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordflow">if</span>(xtbdata%level == 1)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      gav = <a class="code" href="namespacextb__coulomb__klopmanohno.html#aba5e0b4fc673daadcaf56fbe4e953aca">gamaverage</a>%harmonic</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordflow">else</span> <span class="comment">!GFN2</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      gav = <a class="code" href="namespacextb__coulomb__klopmanohno.html#aba5e0b4fc673daadcaf56fbe4e953aca">gamaverage</a>%arithmetic</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keyword">call </span><a class="code" href="interfacextb__mctc__lapack__eigensolve_1_1init.html">init</a>(coulomb, env, mol, gav, xtbdata%coulomb%shellHardness, &amp;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      &amp; xtbdata%coulomb%gExp, num=idnum, nshell=xtbdata%nShell)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="keyword">call </span>env%check(exitrun)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="keywordflow">if</span> (exitrun) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keyword">call </span>env%error(<span class="stringliteral">&quot;Setup of Coulomb evaluator failed&quot;</span>, source)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="keyword">call </span>coulomb%getCoulombMatrix(mol, ies%jmat)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">!  J potentials including the point charge stuff</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keyword">allocate</span>(vpc(basis%nshell))</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   vpc(:) = 0.0_wp</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="keywordflow">if</span>(lpcem)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">if</span> (xtbdata%level == 1)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;         <span class="keyword">call </span>jpot_pcem_gfn1(xtbdata%coulomb,mol%n,pcem,xtbdata%nshell,mol%at, &amp;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            &amp; mol%xyz,xtbdata%coulomb%gExp,vpc)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">else</span> <span class="comment">! GFN2</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;         <span class="keyword">call </span>jpot_pcem_gfn2(xtbdata%coulomb,mol%n,pcem,xtbdata%nshell,mol%at, &amp;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            &amp; mol%xyz,vpc)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   <span class="keywordflow">if</span> (prlevel &gt; 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keyword">write</span>(env%unit,<span class="stringliteral">&#39;(/,10x,51(&quot;.&quot;))&#39;</span>)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keyword">write</span>(env%unit,<span class="stringliteral">&#39;(10x,&quot;:&quot;,22x,a,22x,&quot;:&quot;)&#39;</span>) <span class="stringliteral">&quot;SETUP&quot;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keyword">write</span>(env%unit,<span class="stringliteral">&#39;(10x,&quot;:&quot;,49(&quot;.&quot;),&quot;:&quot;)&#39;</span>)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keyword">write</span>(env%unit,intfmt) <span class="stringliteral">&quot;# basis functions  &quot;</span>,basis%nbf</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keyword">write</span>(env%unit,intfmt) <span class="stringliteral">&quot;# atomic orbitals  &quot;</span>,basis%nao</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keyword">write</span>(env%unit,intfmt) <span class="stringliteral">&quot;# shells           &quot;</span>,basis%nshell</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keyword">write</span>(env%unit,intfmt) <span class="stringliteral">&quot;# electrons        &quot;</span>,wfn%nel</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(xtbdata%halogen)) &amp;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keyword">write</span>(env%unit,intfmt) <span class="stringliteral">&quot;# halogen bonds    &quot;</span>,nxb</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keyword">write</span>(env%unit,intfmt) <span class="stringliteral">&quot;max. iterations    &quot;</span>,maxiter</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordflow">if</span> (xtbdata%level == 2) &amp;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keyword">write</span>(env%unit,chrfmt) <span class="stringliteral">&quot;Hamiltonian        &quot;</span>,<span class="stringliteral">&quot;GFN2-xTB&quot;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">if</span> (xtbdata%level == 1) &amp;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keyword">write</span>(env%unit,chrfmt) <span class="stringliteral">&quot;Hamiltonian        &quot;</span>,<span class="stringliteral">&quot;GFN1-xTB&quot;</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keyword">write</span>(env%unit,chrfmt) <span class="stringliteral">&quot;restarted?         &quot;</span>,<a class="code" href="namespacextb__readin.html#a3f2a0a4ba8d18c910b3a058712e42867">bool2string</a>(restart)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keyword">write</span>(env%unit,chrfmt) <span class="stringliteral">&quot;GBSA solvation     &quot;</span>,<a class="code" href="namespacextb__readin.html#a3f2a0a4ba8d18c910b3a058712e42867">bool2string</a>(<span class="keyword">allocated</span>(solvation))</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keyword">write</span>(env%unit,chrfmt) <span class="stringliteral">&quot;PC potential       &quot;</span>,<a class="code" href="namespacextb__readin.html#a3f2a0a4ba8d18c910b3a058712e42867">bool2string</a>(lpcem)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">if</span> (lpcem) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         <span class="keyword">write</span>(env%unit,intfmt) <span class="stringliteral">&quot;-&gt; # point charges &quot;</span>,pcem%n</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;         <span class="keyword">write</span>(env%unit,dblfmt) <span class="stringliteral">&quot;-&gt; sum of PC       &quot;</span>,sum(pcem%q),<span class="stringliteral">&quot;e   &quot;</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keyword">write</span>(env%unit,dblfmt) <span class="stringliteral">&quot;electronic temp.   &quot;</span>,et,      <span class="stringliteral">&quot;K   &quot;</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keyword">write</span>(env%unit,dblfmt) <span class="stringliteral">&quot;accuracy           &quot;</span>,acc,     <span class="stringliteral">&quot;    &quot;</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keyword">write</span>(env%unit,scifmt) <span class="stringliteral">&quot;-&gt; integral cutoff &quot;</span>,intcut,  <span class="stringliteral">&quot;    &quot;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keyword">write</span>(env%unit,scifmt) <span class="stringliteral">&quot;-&gt; integral neglect&quot;</span>,neglect, <span class="stringliteral">&quot;    &quot;</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keyword">write</span>(env%unit,scifmt) <span class="stringliteral">&quot;-&gt; SCF convergence &quot;</span>,scfconv, <span class="stringliteral">&quot;Eh  &quot;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keyword">write</span>(env%unit,scifmt) <span class="stringliteral">&quot;-&gt; wf. convergence &quot;</span>,qconv,   <span class="stringliteral">&quot;e   &quot;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keyword">write</span>(env%unit,dblfmt) <span class="stringliteral">&quot;Broyden damping    &quot;</span>,<a class="code" href="namespacextb__setparam.html#ad9bb2e1e26c88868fd69cdcf78c7662c">broydamp</a>,<span class="stringliteral">&quot;    &quot;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keyword">write</span>(env%unit,<span class="stringliteral">&#39;(10x,51(&quot;.&quot;))&#39;</span>)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   qq    =wfn%q</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   damp  =damp0</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(1)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(3,<span class="stringliteral">&quot;classical contributions&quot;</span>)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   <span class="comment">! Repulsion energy</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   ep = 0.0_wp</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <span class="keyword">call </span>latp%getLatticePoints(trans, 40.0_wp)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   <span class="keyword">call </span><a class="code" href="interfacextb__xtb__repulsion_1_1repulsionengrad.html">repulsionengrad</a>(mol, xtbdata%repulsion, trans, 40.0_wp, &amp;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      &amp; ep, gradient, sigma)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="comment">! Halogen bond correction</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   exb=0.0_wp</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(xtbdata%halogen)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">if</span> (nxb &gt; 0 .and. mol%npbc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;         <span class="keyword">call </span>env%error(<span class="stringliteral">&quot;Halogen bond correction not available with PBC&quot;</span>, source)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;         <span class="keywordflow">return</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__xtb__halogen.html#a56fea9732619a8800ea9c33900991c68">xbpot</a>(xtbdata%halogen,mol%n,mol%at,mol%xyz,xblist,nxb,&amp;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;         &amp; ljexp,exb,gradient)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(3)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(2,<span class="stringliteral">&quot;Dispersion&quot;</span>)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <span class="comment">! Coordination number</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="keywordflow">if</span> (xtbdata%level == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="comment">! D3 part first because we need CN</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacextb__disp__coordinationnumber_1_1getcoordinationnumber.html">getcoordinationnumber</a>(mol, trans, 40.0_wp, <a class="code" href="namespacextb__disp__coordinationnumber.html#ac64182ab5b87c4aeaae673862b4dd968">cntype</a>%exp, cn, dcndr, dcndl)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="comment">! CN/dCN replaced by special smoother and faster decaying function</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacextb__disp__coordinationnumber_1_1getcoordinationnumber.html">getcoordinationnumber</a>(mol, trans, 40.0_wp, <a class="code" href="namespacextb__disp__coordinationnumber.html#ac64182ab5b87c4aeaae673862b4dd968">cntype</a>%gfn, cn, dcndr, dcndl)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <span class="comment">! dispersion (DFT-D type correction)</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="keyword">call </span>latp%getLatticePoints(trans, 60.0_wp)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keywordflow">if</span> (xtbdata%level == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacextb__disp__dftd3_1_1d3__gradient.html">d3_gradient</a> &amp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;         &amp; (mol, trans, xtbdata%dispersion%dpar, 4.0_wp, 60.0_wp, &amp;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;         &amp;  cn, dcndr, dcndl, ed, gradient, sigma)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keyword">allocate</span>(scd4)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacextb__mctc__lapack__eigensolve_1_1init.html">init</a>(scd4, xtbdata%dispersion, mol)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(2)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(4,<span class="stringliteral">&quot;integral evaluation&quot;</span>)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="comment">! Overlap integrals</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <span class="keyword">allocate</span>(dpint(3,basis%nao,basis%nao), &amp;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      &amp;     qpint(6,basis%nao,basis%nao), &amp;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      &amp;     source = 0.0_wp)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <span class="keyword">call </span><a class="code" href="interfacextb__xtb__hamiltonian_1_1getselfenergy.html">getselfenergy</a>(xtbdata%hamiltonian, xtbdata%nShell, mol%at, cn=cn, &amp;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      &amp; selfenergy=selfenergy, dsedcn=dsedcn)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   <span class="comment">! compute integrals and prescreen to set up list arrays</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <span class="keyword">call </span>latp%getLatticePoints(trans, sqrt(800.0_wp))</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor">#ifdef XTB_GPU</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor"></span>   <span class="keyword">call </span><a class="code" href="namespacextb__xtb__hamiltonian__gpu.html#aee3ffc022ae0b9686cef17ce77e6b117">build_sdqh0_gpu</a>(xtbdata%nShell, xtbdata%hamiltonian, mol%n, mol%at, &amp;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      &amp; basis%nbf, basis%nao, mol%xyz, trans, selfenergy, intcut, &amp;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      &amp; basis%caoshell, basis%saoshell, basis%nprim, basis%primcount, basis%alp, &amp;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      &amp; basis%cont, s, dpint, qpint, h0)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor"></span>   <span class="keyword">call </span><a class="code" href="namespacextb__xtb__hamiltonian.html#a9f0d8be35a4ef0f2dbbbafd2ef873d64">build_sdqh0</a>(xtbdata%nShell, xtbdata%hamiltonian, mol%n, mol%at, &amp;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      &amp; basis%nbf, basis%nao, mol%xyz, trans, selfenergy, intcut, &amp;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      &amp; basis%caoshell, basis%saoshell, basis%nprim, basis%primcount, basis%alp, &amp;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      &amp; basis%cont, s, dpint, qpint, h0)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="preprocessor"></span>   <span class="keyword">call </span><a class="code" href="namespacextb__xtb__hamiltonian.html#a452ff391a1572caaeec2ca34bca16bc8">count_dpint</a>(ndp, dpint, neglect)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="keyword">call </span><a class="code" href="namespacextb__xtb__hamiltonian.html#acea5bedffd7dfd433b664c7729cdd3b2">count_qpint</a>(nqp, qpint, neglect)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <span class="comment">! prepare aes stuff</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(xtbdata%multipole)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">if</span> (mol%npbc &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;         <span class="keyword">call </span>env%error(<span class="stringliteral">&quot;Multipoles not available with PBC&quot;</span>, source)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;         <span class="keywordflow">return</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keyword">allocate</span>(aes)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacextb__mctc__lapack__eigensolve_1_1init.html">init</a>(aes, xtbdata%multipole)</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="comment">! allocate arrays for lists and fill (to exploit sparsity)</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keyword">allocate</span>(mdlst(2,ndp),mqlst(2,nqp))</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keyword">call </span>setdqlist(basis%nao,ndp,nqp,neglect,dpint,qpint,mdlst,mqlst)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="comment">! set up 1/R^n * damping function terms</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      ii=mol%n*(mol%n+1)/2</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keyword">allocate</span>(aes%gab3(mol%n, mol%n),aes%gab5(mol%n, mol%n),radcn(mol%n))</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keyword">call </span>get_radcn(xtbdata%multipole,mol%n,mol%at,cn,aes%cnShift, &amp;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;         &amp; aes%cnExp,aes%cnRMax,radcn)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keyword">call </span>mmomgabzero(mol%n,mol%at,mol%xyz,aes%dipDamp, &amp;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;         &amp; aes%quadDamp,radcn,aes%gab3,aes%gab5) <span class="comment">! zero damping</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <span class="comment">! prepare matrix indices</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   nmat =0</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   nmat2=0</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="keywordflow">do</span> ii=1,basis%nao</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      iat=basis%aoat2(ii)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">do</span> jj=1,ii-1</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;         jat=basis%aoat2(jj)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;         <span class="keywordflow">if</span>(abs(s(jj,ii)).lt.neglect) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            s(jj,ii)=0.0_wp</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            s(ii,jj)=0.0_wp</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            cycle</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;         nmat=nmat+1</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;         matlist(1,nmat)=ii</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;         matlist(2,nmat)=jj</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;         <span class="keywordflow">if</span>(iat.ne.jat)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            nmat2=nmat2+1</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            matlist2(1,nmat2)=ii</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            matlist2(2,nmat2)=jj</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="comment">! CB: moved this here so j/i indices from matlist come in a reasonable order</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="comment">! also setup CN dep. stuff</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      nmat=nmat+1</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      matlist(1,nmat)=ii</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      matlist(2,nmat)=ii</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      ishell=<a class="code" href="namespacextb__grad__core.html#aa81adbbc26b2bb71b10652fad6c0b442">mmm</a>(basis%lao2(ii))</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordflow">   enddo</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(4)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(5,<span class="stringliteral">&quot;iterations&quot;</span>)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   <span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <span class="comment">! SCC iterations</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="keywordflow">if</span>(pr)<span class="keywordflow">then</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keyword">write</span>(env%unit,<span class="stringliteral">&#39;(a)&#39;</span>)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keyword">write</span>(env%unit,*) <span class="stringliteral">&#39;iter      E             dE          RMSdq&#39;</span>, &amp;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      &amp;<span class="stringliteral">&#39;      gap      omega  full diag&#39;</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="comment">!$acc enter data copyin(s, dpint, qpint)</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <span class="keyword">call </span><a class="code" href="interfacextb__mctc__lapack__eigensolve_1_1init.html">init</a>(solver, env, s)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <span class="keyword">call </span><a class="code" href="namespacextb__scc__core.html#a3e0e142b640924088ca8b0ab266dd5e0">scc</a>(env,xtbdata,solver,mol%n,wfn%nel,wfn%nopen,basis%nao,ndp,nqp,nmat,basis%nshell, &amp;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      &amp;     mol%at,matlist,mdlst,mqlst,basis%aoat2,basis%ao2sh,basis%ash, &amp;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      &amp;     wfn%q,wfn%dipm,wfn%qp,qq,qlmom,wfn%qsh,zsh, &amp;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      &amp;     mol%xyz,aes, &amp;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      &amp;     cm5,cm5a,gsolv,solvation, &amp;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      &amp;     scd4, &amp;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      &amp;     broy,<a class="code" href="namespacextb__setparam.html#ad9bb2e1e26c88868fd69cdcf78c7662c">broydamp</a>,damp0, &amp;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      &amp;     lpcem,ves,vpc, &amp;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      &amp;     et,wfn%focc,wfn%focca,wfn%foccb,wfn%efa,wfn%efb, &amp;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      &amp;     eel,ees,eaes,epol,ed,epcem,egap, &amp;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      &amp;     wfn%emo,wfn%ihomo,wfn%ihomoa,wfn%ihomob, &amp;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      &amp;     h0,wfn%C,s,dpint,qpint,x,wfn%P,ies, &amp;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      &amp;     maxiter,startpdiag,scfconv,qconv, &amp;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      &amp;     minpr,pr, &amp;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      &amp;     fail,jter)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   <span class="comment">!$acc exit data delete(s, dpint, qpint)</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   <span class="comment">! check if something terrible happend in the SCC</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   <span class="keyword">call </span>env%check(exitrun)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   <span class="keywordflow">if</span> (exitrun) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keyword">call </span>env%error(<span class="stringliteral">&quot;Self consistent charge iterator terminated&quot;</span>, source)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="comment">! check for convergence, only do this if printlevel is maximal (WHY?)</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   res % converged = .not. fail</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="keywordflow">if</span> (fail) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keyword">call </span>env%warning(<span class="stringliteral">&quot;Self consistent charge iterator did not converge&quot;</span>, source)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <span class="keywordflow">if</span> (pr) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">if</span> (fail) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;         <span class="keyword">call </span><a class="code" href="filetools_8F90.html#a9fc5b6efd50784b6c6d5a668d490a4e2">touch_file</a>(<span class="stringliteral">&#39;.sccnotconverged&#39;</span>)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;         <span class="keyword">write</span>(env%unit,<span class="stringliteral">&#39;(/,3x,&quot;***&quot;,1x,a,1x,i0,1x,a,1x,&quot;***&quot;)&#39;</span>) &amp;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="stringliteral">&quot;convergence criteria cannot be satisfied within&quot;</span>,jter,<span class="stringliteral">&quot;iterations&quot;</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;         <span class="keyword">write</span>(env%unit,<span class="stringliteral">&#39;(/,3x,&quot;***&quot;,1x,a,1x,i0,1x,a,1x,&quot;***&quot;)&#39;</span>) &amp;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="stringliteral">&quot;convergence criteria satisfied after&quot;</span>,jter,<span class="stringliteral">&quot;iterations&quot;</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(5)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   <span class="keywordflow">if</span> (.not.pr.and.<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>.and.minpr) &amp;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%write_timing(env%unit,5,<span class="stringliteral">&#39;SCC iter.&#39;</span>)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(6,<span class="stringliteral">&quot;molecular gradient&quot;</span>)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   <span class="comment">! GRADIENT (finally 100% analytical)</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   <span class="keyword">allocate</span>(temp(basis%nao))</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <span class="keyword">allocate</span>(pew(basis%nao, basis%nao))</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   <span class="keyword">allocate</span>(shellshift(maxval(xtbdata%nshell), mol%n))</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   <span class="keyword">allocate</span>(dhdcn(mol%n))</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   temp(:) = wfn%focc * wfn%emo * <a class="code" href="namespacextb__mctc__convert.html#acdf2e027ee943efa9cc9a6b4701e3810">evtoau</a></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   <span class="keyword">call </span><a class="code" href="namespacextb__scc__core.html#af5c3cd803d403c23fc0ae9c2eb1229c6">dmat</a>(basis%nao, temp, wfn%C, pew)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   shellshift(:, :) = 0.0_wp</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   i = 0</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   <span class="keywordflow">do</span> iat = 1, mol%n</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      ati = mol%at(iat)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">do</span> is = 1, xtbdata%nShell(ati)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;         shellshift(is, iat) = ves(i+is)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      i = i+xtbdata%nShell(ati)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="keywordflow">   end do</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <span class="keyword">allocate</span>(vs(mol%n),vd(3,mol%n),vq(6,mol%n), source = 0.0_wp)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(xtbdata%multipole)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="comment">! VS, VD, VQ-dependent potentials are changed w.r.t. SCF,</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="comment">! since moment integrals are now computed with origin at</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="comment">! respective atoms</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__aespot.html#a06cbb099be359bfaf05f04c3b6488275">setdvsdq</a>(xtbdata%multipole, mol%n, mol%at, mol%xyz, wfn%q, wfn%dipm, &amp;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;         &amp; wfn%qp, aes%gab3, aes%gab5, vs, vd, vq)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   dhdcn(:) = 0.0_wp</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="preprocessor">#ifdef XTB_GPU</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="preprocessor"></span>   <span class="keyword">call </span>latp%getLatticePoints(trans, sqrt(800.0_wp))</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   <span class="keyword">call </span><a class="code" href="namespacextb__xtb__hamiltonian__gpu.html#a3fc32a40afb82002170a6633d8870ddb">build_dsdqh0_gpu</a>(xtbdata%nShell, xtbdata%hamiltonian, selfenergy, dsedcn, &amp;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      &amp; intcut, mol%n, basis%nao, basis%nbf, mol%at, mol%xyz, trans, &amp;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      &amp; basis%caoshell, basis%saoshell, basis%nprim, basis%primcount, &amp;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      &amp; basis%alp, basis%cont, wfn%p, pew, shellshift, vs, vd, vq, &amp;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      &amp; dhdcn, gradient, sigma)</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor"></span>   <span class="keywordflow">if</span> (mol%npbc == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keyword">allocate</span>(h(basis%nao, basis%nao))</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      h(:, :) = 0.0_wp</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordflow">do</span> m = 1, nmat2</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;         i = matlist2(1,m)</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;         j = matlist2(2,m)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;         k = j+i*(i-1)/2</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;         <span class="comment">!ishell = ao2sh(i)</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;         <span class="comment">!jshell = ao2sh(j)</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;         <span class="comment">! SCC terms</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;         <span class="comment">!eh1 = autoev*(shellShift(ishell) + shellShift(jshell))</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;         <span class="comment">!H1 = -S(j,i)*eh1*0.5_wp</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;         h(j,i) = h0(k)*<a class="code" href="namespacextb__mctc__convert.html#acdf2e027ee943efa9cc9a6b4701e3810">evtoau</a>/s(j,i)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;         h(i,j) = h(j,i)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__xtb__hamiltonian.html#a299eaa3877160d0aff3f63dc55b12fde">build_dsdqh0_noreset</a>(xtbdata%nShell, xtbdata%hamiltonian, selfenergy, &amp;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;         &amp; dsedcn, intcut, mol%n, basis%nao, basis%nbf, mol%at, mol%xyz, &amp;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;         &amp; basis%caoshell, basis%saoshell, basis%nprim, basis%primcount, &amp;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;         &amp; basis%alp, basis%cont, h, s, wfn%p, pew, shellshift, vs, vd, vq, &amp;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;         &amp; dhdcn, gradient, sigma)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__xtb__hamiltonian.html#a8364d9293f8dac8d5de89c5186f7effc">build_dsdqh0</a>(xtbdata%nShell, xtbdata%hamiltonian, selfenergy, dsedcn, &amp;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;         &amp; intcut, mol%n, basis%nao, basis%nbf, mol%at, mol%xyz, trans, &amp;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;         &amp; basis%caoshell, basis%saoshell, basis%nprim, basis%primcount, &amp;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;         &amp; basis%alp, basis%cont, wfn%p, pew, shellshift, vs, vd, vq, &amp;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;         &amp; dhdcn, gradient, sigma)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor"></span>   <span class="comment">! setup CN gradient</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="keyword">call </span>mctc_gemv(dcndr, dhdcn, gradient, beta=1.0_wp)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <span class="keyword">call </span>mctc_gemv(dcndl, dhdcn, sigma, beta=1.0_wp)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   <span class="comment">! multipole gradient</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(xtbdata%multipole)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="comment">! VS, VD, VQ-dependent potentials are changed w.r.t. SCF,</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="comment">! since moment integrals are now computed with origin at</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="comment">! respective atoms</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__aespot.html#a06cbb099be359bfaf05f04c3b6488275">setdvsdq</a>(xtbdata%multipole, mol%n, mol%at, mol%xyz, wfn%q, wfn%dipm, &amp;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;         &amp; wfn%qp, aes%gab3, aes%gab5, vs, vd, vq)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="comment">! WARNING: dcndr is overwritten on output and now dR0A/dXC</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__aespot.html#ada4b51d45f3c4e52276d0d8619ebc5e9">dradcn</a>(xtbdata%multipole, mol%n, mol%at, cn, aes%cnShift, &amp;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;         &amp; aes%cnExp, aes%cnRMax, dcndr)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__aespot.html#aab7af529842cf50edec5a2df03b28042">aniso_grad</a>(mol%n, mol%at, mol%xyz, wfn%q, wfn%dipm, wfn%qp, &amp;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;         &amp; aes%dipDamp, aes%quadDamp, radcn, dcndr, aes%gab3, aes%gab5, gradient)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   <span class="comment">! dispersion (DFT-D type correction)</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(scd4)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keyword">call </span>latp%getLatticePoints(trans, 40.0_wp)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacextb__disp__coordinationnumber_1_1getcoordinationnumber.html">getcoordinationnumber</a>(mol, trans, 40.0_wp, <a class="code" href="namespacextb__disp__coordinationnumber.html#ac64182ab5b87c4aeaae673862b4dd968">cntype</a>%cov, &amp;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;         &amp; cn, dcndr, dcndl)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keyword">call </span>latp%getLatticePoints(trans, 60.0_wp)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keyword">call </span><a class="code" href="interfacextb__disp__dftd4_1_1d4__gradient.html">d4_gradient</a>(mol, xtbdata%dispersion%dispm, trans, &amp;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;         &amp;  xtbdata%dispersion%dpar, scd4%g_a, scd4%g_c, &amp;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;         &amp;  scd4%wf, 60.0_wp, 40.0_wp, cn, dcndr, dcndl, wfn%q, &amp;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;         &amp;  energy=dum, gradient=gradient, sigma=sigma, e3=embd)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;   <span class="comment">! Solvation contributions from GBSA</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(solvation)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      cm5(:)=wfn%q+cm5a</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keyword">call </span>solvation%addGradient(env, mol%at, mol%xyz, cm5, wfn%qsh, gradient)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">select type</span>(solvation)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keywordflow">      type is</span> (<a class="code" href="structxtb__solv__gbsa_1_1tborn.html">tborn</a>)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;         <span class="keywordflow">if</span> (xtbdata%level == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keyword">call </span>mctc_gemv(solvation%bornMat, cm5, solvation%shift)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keyword">call </span>mctc_gemv(dcm5a, solvation%shift, gradient, beta=1.0_wp)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;         <span class="keyword">call </span>solvation%getEnergyParts(env, cm5, wfn%qsh, gborn, ghb, gsasa, &amp;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            &amp; gshift)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;         gsolv = gborn+gsasa+ghb+gshift</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="comment">! Derivative of electrostatic energy</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;   <span class="keyword">allocate</span>(djdr(3, mol%n, basis%nshell))</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   <span class="keyword">allocate</span>(djdtr(3, basis%nshell))</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;   <span class="keyword">allocate</span>(djdl(3, 3, basis%nshell))</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   <span class="keyword">call </span>coulomb%getCoulombDerivs(mol, wfn%qsh, djdr, djdtr, djdl)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <span class="keyword">call </span>mctc_gemv(djdr, wfn%qsh, gradient, beta=1.0_wp)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <span class="comment">!call mctc_gemv(djdL, wfn%qsh, sigma, beta=1.0_wp)</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   <span class="comment">! ES point charge embedding</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <span class="keywordflow">if</span> (lpcem) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordflow">if</span> (xtbdata%level == 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;         <span class="keyword">call </span><a class="code" href="namespacextb__embedding.html#a4263d2b3a7715ad81f6d2eb124f6cbf4">pcem_grad_gfn1</a>(xtbdata%coulomb,gradient,pcem%grd,mol%n,pcem,mol%at, &amp;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            &amp; xtbdata%nshell,mol%xyz,xtbdata%coulomb%gExp,wfn%qsh)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;         <span class="keyword">call </span><a class="code" href="namespacextb__embedding.html#afb99088275fac655b0730d04664b4fcd">pcem_grad_gfn2</a>(xtbdata%coulomb,gradient,pcem%grd,mol%n,pcem,mol%at, &amp;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            &amp; xtbdata%nshell,mol%xyz,wfn%qsh)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(6)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   <span class="keywordflow">if</span> (.not.pr.and.<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>.and.minpr) &amp;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%write_timing(env%unit,6,<span class="stringliteral">&#39;gradient&#39;</span>)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(7,<span class="stringliteral">&quot;printout&quot;</span>)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   <span class="comment">! PROPERTIES &amp; PRINTOUT</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   printing: <span class="keywordflow">if</span> (pr) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="comment">! ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="comment">! print orbital energies and occupation numbers</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacextb__setparam.html#ab9325abbf76b443fcbcea253cbbcb713">pr_eig</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;         <span class="keyword">call </span><a class="code" href="property_8F90.html#a6592073970291ef51906258c283114fd">print_orbital_eigenvalues</a>(env%unit, wfn, 5)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="comment">! ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="comment">! HOMO-LUMO excitation properties if UHF=2</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">if</span> (wfn%nopen.eq.2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;         <span class="keyword">call </span><a class="code" href="namespacextb__hlex.html#a9567145f01de2589b8d5a029c45d42db">hlex</a>(mol%n, mol%at, basis%nbf, basis%nao, wfn%ihomoa, mol%xyz, &amp;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            &amp; wfn%focc, s, wfn%C, wfn%emo, basis)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="comment">! ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="comment">! LMO /xTB-IFF</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacextb__setparam.html#ae4ed97406117d0e94497eb8b62af5533">pr_lmo</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;         tmp=wfn%emo*<a class="code" href="namespacextb__mctc__convert.html#acdf2e027ee943efa9cc9a6b4701e3810">evtoau</a></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;         <span class="keyword">call </span><a class="code" href="namespacextb__local.html#a6aafec43f9ac7235a5dfd2c36ed1f56b">local</a>(mol%n, mol%at, basis%nbf, basis%nao, wfn%ihomoa, mol%xyz, &amp;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            &amp; mol%z, wfn%focc, s, wfn%P, wfn%C, tmp, wfn%q, eel, &amp;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            &amp; <span class="keyword">allocated</span>(solvation), basis)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="keywordflow">   endif</span> printing</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <span class="comment">! get Wiberg bond orders</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;   <span class="keyword">call </span><a class="code" href="namespacextb__scc__core.html#a2cc45bad34d8ad8fc414f3a2929c4d54">get_wiberg</a>(mol%n, basis%nao, mol%at, mol%xyz, wfn%P, s, wfn%wbo, &amp;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      &amp; basis%fila2)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   <span class="comment">! ------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="comment">! dipole calculation (always done because its free)</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <span class="keywordflow">if</span> (.not.<span class="keyword">allocated</span>(xtbdata%multipole)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keyword">call </span>mmompop(mol%n,basis%nao,basis%aoat2,mol%xyz,wfn%p,s,dpint,qpint, &amp;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;         &amp;         wfn%dipm,wfn%qp)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <span class="keyword">call </span><a class="code" href="namespacextb__dipole.html#ac27c8b4111d2b88f5b3b78c12021b8ba">calc_dipole</a>(mol%n,mol%at,mol%xyz,mol%z,basis%nao,wfn%P,dpint,dip,dipol)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%measure(7)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;   <span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;   <span class="comment">! SAVE FOR FINAL PRINTOUT</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;   <span class="comment">! total energy</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;   energy = eel + ep + exb + embd</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;   eat = eatoms*<a class="code" href="namespacextb__mctc__convert.html#acdf2e027ee943efa9cc9a6b4701e3810">evtoau</a> - energy</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;   <span class="keywordflow">if</span> (.not.<span class="keyword">allocated</span>(scd4)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      energy = energy + ed</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="keywordflow">   endif</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;   res%e_elec  = eel</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   res%e_atom  = eat</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   res%e_rep   = ep</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   res%e_es    = ees</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   res%e_aes   = eaes</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;   res%e_axc   = epol</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;   res%e_disp  = ed+embd</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;   res%e_total = energy</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;   res%hl_gap  = egap</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;   res%dipole  = dipol</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(xtbdata%halogen)) res%e_xb = exb</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(solvation)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      res%g_solv  = gsolv</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      res%g_born  = gborn</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      res%g_sasa  = gsasa</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      res%g_hb    = ghb</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      res%g_shift = gshift</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="keywordflow">   end if</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   res%gnorm = norm2(gradient)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>.and.pr) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%write(env%unit,<span class="stringliteral">&#39;SCC&#39;</span>)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">! ========================================================================</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">profile</a>) <span class="keyword">call </span><a class="code" href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">timer</a>%deallocate</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="keyword">end subroutine </span><a class="code" href="namespacextb__scf.html#a7390c40a38032c3d210c39edecfa49ed">scf</a></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno"><a class="line" href="namespacextb__scf.html#aea2b7ba8bdd6ff29e75c5c3008c3ea20">  883</a></span>&#160;<span class="keywordtype">pure</span> <span class="keywordtype">elemental</span> <span class="keyword">function </span><a class="code" href="namespacextb__scf.html#aea2b7ba8bdd6ff29e75c5c3008c3ea20">early3d</a>(i) <span class="keyword">result</span>(bool)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;   <span class="keywordtype">integer</span>,<span class="keywordtype">intent(in)</span> :: i</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   <span class="keywordtype">logical</span> :: bool</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;   bool = .false.</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;   <span class="keywordflow">if</span> ((i.ge.21).and.(i.le.24)) bool = .<a class="code" href="symmetry__i_8c.html#aa77c823a9fc018ae1d437369708d8727">true</a>.</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keyword">end function </span><a class="code" href="namespacextb__scf.html#aea2b7ba8bdd6ff29e75c5c3008c3ea20">early3d</a></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">!  has a parameter of zero in GFN1-xTB</span></div>
<div class="line"><a name="l00894"></a><span class="lineno"><a class="line" href="namespacextb__scf.html#afbb45fadd33b4d004619a75ddf69e0f9">  894</a></span>&#160;<span class="keywordtype">pure</span> <span class="keywordtype">elemental</span> <span class="keyword">function </span><a class="code" href="namespacextb__scf.html#afbb45fadd33b4d004619a75ddf69e0f9">xbond</a>(ati,atj) <span class="keyword">result</span>(bool)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;   <span class="keywordtype">integer</span>,<span class="keywordtype">intent(in)</span> :: ati,atj</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;   <span class="keywordtype">logical</span> :: bool</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   <span class="keywordtype">logical</span> :: lx1,lx2,ly1,ly2</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;   bool=.false.</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;   lx1=.false.</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;   lx2=.false.</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;   ly1=.false.</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   ly2=.false.</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;   <span class="keywordflow">if</span>(ati.eq.17.or.ati.eq.35.or.ati.eq.53.or.ati.eq.85) lx1=.<a class="code" href="symmetry__i_8c.html#aa77c823a9fc018ae1d437369708d8727">true</a>.</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;   <span class="keywordflow">if</span>(atj.eq.17.or.atj.eq.35.or.atj.eq.53.or.atj.eq.85) lx2=.<a class="code" href="symmetry__i_8c.html#aa77c823a9fc018ae1d437369708d8727">true</a>.</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keywordflow">if</span>(ati.eq. 7.or.ati.eq. 8.or.ati.eq.15.or.ati.eq.16) ly1=.<a class="code" href="symmetry__i_8c.html#aa77c823a9fc018ae1d437369708d8727">true</a>.</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   <span class="keywordflow">if</span>(atj.eq. 7.or.atj.eq. 8.or.atj.eq.15.or.atj.eq.16) ly2=.<a class="code" href="symmetry__i_8c.html#aa77c823a9fc018ae1d437369708d8727">true</a>.</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   <span class="keywordflow">if</span>(lx1.and.ly2) bool=.<a class="code" href="symmetry__i_8c.html#aa77c823a9fc018ae1d437369708d8727">true</a>.</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <span class="keywordflow">if</span>(lx2.and.ly1) bool=.<a class="code" href="symmetry__i_8c.html#aa77c823a9fc018ae1d437369708d8727">true</a>.</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="keyword">end function </span><a class="code" href="namespacextb__scf.html#afbb45fadd33b4d004619a75ddf69e0f9">xbond</a></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="keyword">end module </span><a class="code" href="namespacextb__scf.html">xtb_scf</a></div>
<div class="ttc" id="aconstrain__pot_8f90_html_ac62613d43f31c7bfa652ee80083b400b"><div class="ttname"><a href="constrain__pot_8f90.html#ac62613d43f31c7bfa652ee80083b400b">lin</a></div><div class="ttdeci">pure elemental integer function lin(i1, i2)</div><div class="ttdef"><b>Definition:</b> <a href="constrain__pot_8f90_source.html#l00078">constrain_pot.f90:79</a></div></div>
<div class="ttc" id="afiletools_8F90_html_a9fc5b6efd50784b6c6d5a668d490a4e2"><div class="ttname"><a href="filetools_8F90.html#a9fc5b6efd50784b6c6d5a668d490a4e2">touch_file</a></div><div class="ttdeci">subroutine touch_file(name)</div><div class="ttdef"><b>Definition:</b> <a href="filetools_8F90_source.html#l00037">filetools.F90:38</a></div></div>
<div class="ttc" id="ainterfacextb__disp__coordinationnumber_1_1getcoordinationnumber_html"><div class="ttname"><a href="interfacextb__disp__coordinationnumber_1_1getcoordinationnumber.html">xtb_disp_coordinationnumber::getcoordinationnumber</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2disp_2coordinationnumber_8f90_source.html#l00034">coordinationnumber.f90:34</a></div></div>
<div class="ttc" id="ainterfacextb__disp__dftd3_1_1d3__gradient_html"><div class="ttname"><a href="interfacextb__disp__dftd3_1_1d3__gradient.html">xtb_disp_dftd3::d3_gradient</a></div><div class="ttdef"><b>Definition:</b> <a href="src_2disp_2dftd3_8f90_source.html#l00033">dftd3.f90:33</a></div></div>
<div class="ttc" id="ainterfacextb__disp__dftd4_1_1d4__gradient_html"><div class="ttname"><a href="interfacextb__disp__dftd4_1_1d4__gradient.html">xtb_disp_dftd4::d4_gradient</a></div><div class="ttdef"><b>Definition:</b> <a href="dftd4_8F90_source.html#l00038">dftd4.F90:38</a></div></div>
<div class="ttc" id="ainterfacextb__mctc__lapack__eigensolve_1_1init_html"><div class="ttname"><a href="interfacextb__mctc__lapack__eigensolve_1_1init.html">xtb_mctc_lapack_eigensolve::init</a></div><div class="ttdef"><b>Definition:</b> <a href="eigensolve_8F90_source.html#l00053">eigensolve.F90:53</a></div></div>
<div class="ttc" id="ainterfacextb__xtb__hamiltonian_1_1getselfenergy_html"><div class="ttname"><a href="interfacextb__xtb__hamiltonian_1_1getselfenergy.html">xtb_xtb_hamiltonian::getselfenergy</a></div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian_8f90_source.html#l00035">hamiltonian.f90:35</a></div></div>
<div class="ttc" id="ainterfacextb__xtb__repulsion_1_1repulsionengrad_html"><div class="ttname"><a href="interfacextb__xtb__repulsion_1_1repulsionengrad.html">xtb_xtb_repulsion::repulsionengrad</a></div><div class="ttdef"><b>Definition:</b> <a href="repulsion_8F90_source.html#l00031">repulsion.F90:31</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html"><div class="ttname"><a href="namespacextb__aespot.html">xtb_aespot</a></div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00018">aespot.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_a06cbb099be359bfaf05f04c3b6488275"><div class="ttname"><a href="namespacextb__aespot.html#a06cbb099be359bfaf05f04c3b6488275">xtb_aespot::setdvsdq</a></div><div class="ttdeci">subroutine setdvsdq(aesData, nat, at, xyz, q, dipm, qp, gab3, gab5, vs, vd, vq)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00576">aespot.f90:577</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_a49b3c4b26cb3479c91a54e16ca8dc168"><div class="ttname"><a href="namespacextb__aespot.html#a49b3c4b26cb3479c91a54e16ca8dc168">xtb_aespot::setvsdq</a></div><div class="ttdeci">subroutine setvsdq(aesData, nat, at, xyz, q, dipm, qp, gab3, gab5, vs, vd, vq)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00448">aespot.f90:449</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_aa4d2436b7234ef3194dfff0592b1ed7c"><div class="ttname"><a href="namespacextb__aespot.html#aa4d2436b7234ef3194dfff0592b1ed7c">xtb_aespot::dsint</a></div><div class="ttdeci">subroutine dsint(nShell, hData, thr, nat, nao, nbf, at, xyz, sqrab, caoshell, saoshell, nprim, primcount, alp, cont, H, g)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l01125">aespot.f90:1127</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_aab7af529842cf50edec5a2df03b28042"><div class="ttname"><a href="namespacextb__aespot.html#aab7af529842cf50edec5a2df03b28042">xtb_aespot::aniso_grad</a></div><div class="ttdeci">subroutine aniso_grad(nat, at, xyz, q, dipm, qp, kdmp3, kdmp5, radcn, dcn, gab3, gab5, g)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00757">aespot.f90:759</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_ab545f9823d314fe301898e447c29e9d0"><div class="ttname"><a href="namespacextb__aespot.html#ab545f9823d314fe301898e447c29e9d0">xtb_aespot::molmom</a></div><div class="ttdeci">subroutine molmom(iunit, n, xyz, q, dipm, qp, dip, d3)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00675">aespot.f90:676</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_ac7317133fd3c2f90fe508fb06e7acc7a"><div class="ttname"><a href="namespacextb__aespot.html#ac7317133fd3c2f90fe508fb06e7acc7a">xtb_aespot::mmompop</a></div><div class="ttdeci">subroutine mmompop(nat, nao, aoat2, xyz, p, s, dpint, qpint, dipm, qp)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00136">aespot.f90:137</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_ad7ff96626bb3f99be059df5ec72f84f3"><div class="ttname"><a href="namespacextb__aespot.html#ad7ff96626bb3f99be059df5ec72f84f3">xtb_aespot::setdqlist</a></div><div class="ttdeci">subroutine setdqlist(nao, ndp, nqp, thr, dpint, qpint, matdlst, matqlst)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00034">aespot.f90:35</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_ada4b51d45f3c4e52276d0d8619ebc5e9"><div class="ttname"><a href="namespacextb__aespot.html#ada4b51d45f3c4e52276d0d8619ebc5e9">xtb_aespot::dradcn</a></div><div class="ttdeci">subroutine dradcn(aesData, n, at, cn, shift, expo, rmax, dcn)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00979">aespot.f90:980</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_adda1948962d4d0d8b9f83f097cc915af"><div class="ttname"><a href="namespacextb__aespot.html#adda1948962d4d0d8b9f83f097cc915af">xtb_aespot::mmomgabzero</a></div><div class="ttdeci">subroutine mmomgabzero(nat, at, xyz, kdmp3, kdmp5, radcn, gab3, gab5)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00906">aespot.f90:907</a></div></div>
<div class="ttc" id="anamespacextb__aespot_html_adeab7e550551ee5a20061468ec1d9f04"><div class="ttname"><a href="namespacextb__aespot.html#adeab7e550551ee5a20061468ec1d9f04">xtb_aespot::get_radcn</a></div><div class="ttdeci">subroutine get_radcn(aesData, n, at, cn, shift, expo, rmax, radcn)</div><div class="ttdef"><b>Definition:</b> <a href="aespot_8f90_source.html#l00954">aespot.f90:955</a></div></div>
<div class="ttc" id="anamespacextb__coulomb__klopmanohno_html"><div class="ttname"><a href="namespacextb__coulomb__klopmanohno.html">xtb_coulomb_klopmanohno</a></div><div class="ttdoc">Generalized Klopman-Ohno electrostatics.</div><div class="ttdef"><b>Definition:</b> <a href="klopmanohno_8f90_source.html#l00019">klopmanohno.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__coulomb__klopmanohno_html_aba5e0b4fc673daadcaf56fbe4e953aca"><div class="ttname"><a href="namespacextb__coulomb__klopmanohno.html#aba5e0b4fc673daadcaf56fbe4e953aca">xtb_coulomb_klopmanohno::gamaverage</a></div><div class="ttdeci">type(tgamaverageenum), parameter, public gamaverage</div><div class="ttdoc">Actual enumerator for hardnesses.</div><div class="ttdef"><b>Definition:</b> <a href="klopmanohno_8f90_source.html#l00052">klopmanohno.f90:52</a></div></div>
<div class="ttc" id="anamespacextb__dipole_html"><div class="ttname"><a href="namespacextb__dipole.html">xtb_dipole</a></div><div class="ttdef"><b>Definition:</b> <a href="dipole_8f90_source.html#l00017">dipole.f90:17</a></div></div>
<div class="ttc" id="anamespacextb__dipole_html_ac27c8b4111d2b88f5b3b78c12021b8ba"><div class="ttname"><a href="namespacextb__dipole.html#ac27c8b4111d2b88f5b3b78c12021b8ba">xtb_dipole::calc_dipole</a></div><div class="ttdeci">subroutine calc_dipole(n, at, xyz, z, nao, P, dpint, dip, d)</div><div class="ttdef"><b>Definition:</b> <a href="dipole_8f90_source.html#l00094">dipole.f90:95</a></div></div>
<div class="ttc" id="anamespacextb__disp__coordinationnumber_html"><div class="ttname"><a href="namespacextb__disp__coordinationnumber.html">xtb_disp_coordinationnumber</a></div><div class="ttdoc">TODO.</div><div class="ttdef"><b>Definition:</b> <a href="src_2disp_2coordinationnumber_8f90_source.html#l00019">coordinationnumber.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__disp__coordinationnumber_html_ac64182ab5b87c4aeaae673862b4dd968"><div class="ttname"><a href="namespacextb__disp__coordinationnumber.html#ac64182ab5b87c4aeaae673862b4dd968">xtb_disp_coordinationnumber::cntype</a></div><div class="ttdeci">type(tcntypeenum), parameter, public cntype</div><div class="ttdoc">Enumerator for different coordination number types.</div><div class="ttdef"><b>Definition:</b> <a href="src_2disp_2coordinationnumber_8f90_source.html#l00062">coordinationnumber.f90:62</a></div></div>
<div class="ttc" id="anamespacextb__disp__dftd3_html"><div class="ttname"><a href="namespacextb__disp__dftd3.html">xtb_disp_dftd3</a></div><div class="ttdoc">Implementation of DFT-D3 with Becke-Johnson damping.</div><div class="ttdef"><b>Definition:</b> <a href="src_2disp_2dftd3_8f90_source.html#l00019">dftd3.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__disp__dftd4_html"><div class="ttname"><a href="namespacextb__disp__dftd4.html">xtb_disp_dftd4</a></div><div class="ttdef"><b>Definition:</b> <a href="dftd4_8F90_source.html#l00019">dftd4.F90:19</a></div></div>
<div class="ttc" id="anamespacextb__disp__dftd4_html_a2d6ceb85bc38753b6b2b82465a0a99b7"><div class="ttname"><a href="namespacextb__disp__dftd4.html#a2d6ceb85bc38753b6b2b82465a0a99b7">xtb_disp_dftd4::prmolc6</a></div><div class="ttdeci">subroutine prmolc6(molc6, molc8, molpol, nat, at, cn, covcn, q, qlmom, c6ab, alpha, rvdw, hvol)</div><div class="ttdef"><b>Definition:</b> <a href="dftd4_8F90_source.html#l00221">dftd4.F90:223</a></div></div>
<div class="ttc" id="anamespacextb__disp__dftd4_html_a885a7392a062b6c1231b6f6d5cc14bb7"><div class="ttname"><a href="namespacextb__disp__dftd4.html#a885a7392a062b6c1231b6f6d5cc14bb7">xtb_disp_dftd4::edisp_scc</a></div><div class="ttdeci">real(wp) function edisp_scc(dispm, nat, ndim, at, itbl, q, g_a, g_c, wdispmat, gw)</div><div class="ttdef"><b>Definition:</b> <a href="dftd4_8F90_source.html#l00812">dftd4.F90:813</a></div></div>
<div class="ttc" id="anamespacextb__disp__dftd4_html_a8a9a42ff62b20e292e8807b9cfcfb6c0"><div class="ttname"><a href="namespacextb__disp__dftd4.html#a8a9a42ff62b20e292e8807b9cfcfb6c0">xtb_disp_dftd4::d4</a></div><div class="ttdeci">subroutine d4(dispm, nat, ndim, at, wf, g_a, g_c, covcn, gw, c6abns)</div><div class="ttdef"><b>Definition:</b> <a href="dftd4_8F90_source.html#l00582">dftd4.F90:583</a></div></div>
<div class="ttc" id="anamespacextb__disp__dftd4_html_ab5c7be6d2c0d30018b8fc446f517b527"><div class="ttname"><a href="namespacextb__disp__dftd4.html#ab5c7be6d2c0d30018b8fc446f517b527">xtb_disp_dftd4::disppot</a></div><div class="ttdeci">subroutine disppot(dispm, nat, ndim, at, itbl, q, g_a, g_c, wdispmat, gw, hdisp)</div><div class="ttdef"><b>Definition:</b> <a href="dftd4_8F90_source.html#l00726">dftd4.F90:727</a></div></div>
<div class="ttc" id="anamespacextb__disp__dftd4_html_acccc2e9773d4bfb42ab140832703d93d"><div class="ttname"><a href="namespacextb__disp__dftd4.html#acccc2e9773d4bfb42ab140832703d93d">xtb_disp_dftd4::d4dim</a></div><div class="ttdeci">subroutine d4dim(dispm, nat, at, ndim)</div><div class="ttdef"><b>Definition:</b> <a href="dftd4_8F90_source.html#l00205">dftd4.F90:206</a></div></div>
<div class="ttc" id="anamespacextb__disp__dftd4_html_ad5d82a54f14bb80d751e8cd5b805900f"><div class="ttname"><a href="namespacextb__disp__dftd4.html#ad5d82a54f14bb80d751e8cd5b805900f">xtb_disp_dftd4::mdisp</a></div><div class="ttdeci">subroutine mdisp(dispm, nat, ndim, at, q, xyz, g_a, g_c, gw, c6abns, molc6, molc8, molpol, aout, cout, rout, vout)</div><div class="ttdef"><b>Definition:</b> <a href="dftd4_8F90_source.html#l00277">dftd4.F90:279</a></div></div>
<div class="ttc" id="anamespacextb__disp__dftd4_html_ae9b8a103199085161e97465354cf2e59"><div class="ttname"><a href="namespacextb__disp__dftd4.html#ae9b8a103199085161e97465354cf2e59">xtb_disp_dftd4::build_wdispmat</a></div><div class="ttdeci">subroutine build_wdispmat(dispm, nat, ndim, at, itbl, xyz, par, c6abns, gw, wdispmat)</div><div class="ttdef"><b>Definition:</b> <a href="dftd4_8F90_source.html#l00652">dftd4.F90:653</a></div></div>
<div class="ttc" id="anamespacextb__disp__ncoord_html"><div class="ttname"><a href="namespacextb__disp__ncoord.html">xtb_disp_ncoord</a></div><div class="ttdef"><b>Definition:</b> <a href="ncoord_8f90_source.html#l00042">ncoord.f90:42</a></div></div>
<div class="ttc" id="anamespacextb__disp__ncoord_html_a5eb6e31ff90fa87ffedc75b984dc982f"><div class="ttname"><a href="namespacextb__disp__ncoord.html#a5eb6e31ff90fa87ffedc75b984dc982f">xtb_disp_ncoord::dncoord_d3</a></div><div class="ttdeci">pure subroutine dncoord_d3(nat, at, xyz, cn, dcndr, thr)</div><div class="ttdef"><b>Definition:</b> <a href="ncoord_8f90_source.html#l00331">ncoord.f90:332</a></div></div>
<div class="ttc" id="anamespacextb__disp__ncoord_html_ad4ff09ec5e463a106638e914996b381c"><div class="ttname"><a href="namespacextb__disp__ncoord.html#ad4ff09ec5e463a106638e914996b381c">xtb_disp_ncoord::dncoord_gfn</a></div><div class="ttdeci">pure subroutine dncoord_gfn(nat, at, xyz, cn, dcndr, thr)</div><div class="ttdef"><b>Definition:</b> <a href="ncoord_8f90_source.html#l00900">ncoord.f90:901</a></div></div>
<div class="ttc" id="anamespacextb__disp__ncoord_html_af0b7bd632f8b73879b2a5626d4cb3bf1"><div class="ttname"><a href="namespacextb__disp__ncoord.html#af0b7bd632f8b73879b2a5626d4cb3bf1">xtb_disp_ncoord::ncoord_d4</a></div><div class="ttdeci">pure subroutine ncoord_d4(nat, at, xyz, cn, thr)</div><div class="ttdef"><b>Definition:</b> <a href="ncoord_8f90_source.html#l00575">ncoord.f90:576</a></div></div>
<div class="ttc" id="anamespacextb__embedding_html"><div class="ttname"><a href="namespacextb__embedding.html">xtb_embedding</a></div><div class="ttdef"><b>Definition:</b> <a href="embedding_8f90_source.html#l00018">embedding.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__embedding_html_a22c5a1934d3f04d2bc6d7eba340194c2"><div class="ttname"><a href="namespacextb__embedding.html#a22c5a1934d3f04d2bc6d7eba340194c2">xtb_embedding::jpot_pcem_gfn1</a></div><div class="ttdeci">subroutine jpot_pcem_gfn1(jData, n, pcem, nshell, at, xyz, alphaj, Vpc)</div><div class="ttdef"><b>Definition:</b> <a href="embedding_8f90_source.html#l00188">embedding.f90:189</a></div></div>
<div class="ttc" id="anamespacextb__embedding_html_a4263d2b3a7715ad81f6d2eb124f6cbf4"><div class="ttname"><a href="namespacextb__embedding.html#a4263d2b3a7715ad81f6d2eb124f6cbf4">xtb_embedding::pcem_grad_gfn1</a></div><div class="ttdeci">subroutine pcem_grad_gfn1(jData, g, gpc, n, pcem, at, nshell, xyz, alphaj, qsh)</div><div class="ttdef"><b>Definition:</b> <a href="embedding_8f90_source.html#l00285">embedding.f90:286</a></div></div>
<div class="ttc" id="anamespacextb__embedding_html_a7645c382151a4818907659d7d1cedce0"><div class="ttname"><a href="namespacextb__embedding.html#a7645c382151a4818907659d7d1cedce0">xtb_embedding::jpot_pcem_gfn2</a></div><div class="ttdeci">subroutine jpot_pcem_gfn2(jData, n, pcem, nshell, at, xyz, Vpc)</div><div class="ttdef"><b>Definition:</b> <a href="embedding_8f90_source.html#l00225">embedding.f90:226</a></div></div>
<div class="ttc" id="anamespacextb__embedding_html_af628c36bfe42493ab8e772f39b4559c4"><div class="ttname"><a href="namespacextb__embedding.html#af628c36bfe42493ab8e772f39b4559c4">xtb_embedding::read_pcem</a></div><div class="ttdeci">subroutine read_pcem(iunit, env, pcem, jData)</div><div class="ttdef"><b>Definition:</b> <a href="embedding_8f90_source.html#l00066">embedding.f90:67</a></div></div>
<div class="ttc" id="anamespacextb__embedding_html_afb99088275fac655b0730d04664b4fcd"><div class="ttname"><a href="namespacextb__embedding.html#afb99088275fac655b0730d04664b4fcd">xtb_embedding::pcem_grad_gfn2</a></div><div class="ttdeci">subroutine pcem_grad_gfn2(jData, g, gpc, n, pcem, at, nshell, xyz, qsh)</div><div class="ttdef"><b>Definition:</b> <a href="embedding_8f90_source.html#l00329">embedding.f90:330</a></div></div>
<div class="ttc" id="anamespacextb__grad__core_html"><div class="ttname"><a href="namespacextb__grad__core.html">xtb_grad_core</a></div><div class="ttdef"><b>Definition:</b> <a href="grad__core_8f90_source.html#l00018">grad_core.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__grad__core_html_aa81adbbc26b2bb71b10652fad6c0b442"><div class="ttname"><a href="namespacextb__grad__core.html#aa81adbbc26b2bb71b10652fad6c0b442">xtb_grad_core::mmm</a></div><div class="ttdeci">integer, dimension(20), parameter, private mmm</div><div class="ttdef"><b>Definition:</b> <a href="grad__core_8f90_source.html#l00033">grad_core.f90:33</a></div></div>
<div class="ttc" id="anamespacextb__hlex_html"><div class="ttname"><a href="namespacextb__hlex.html">xtb_hlex</a></div><div class="ttdef"><b>Definition:</b> <a href="hlex_8f90_source.html#l00017">hlex.f90:17</a></div></div>
<div class="ttc" id="anamespacextb__hlex_html_a9567145f01de2589b8d5a029c45d42db"><div class="ttname"><a href="namespacextb__hlex.html#a9567145f01de2589b8d5a029c45d42db">xtb_hlex::hlex</a></div><div class="ttdeci">subroutine hlex(nat, at, nbf, nao, ihomo, xyz, focc, s, cmo, eiga, basis)</div><div class="ttdef"><b>Definition:</b> <a href="hlex_8f90_source.html#l00020">hlex.f90:21</a></div></div>
<div class="ttc" id="anamespacextb__local_html"><div class="ttname"><a href="namespacextb__local.html">xtb_local</a></div><div class="ttdef"><b>Definition:</b> <a href="local_8f90_source.html#l00017">local.f90:17</a></div></div>
<div class="ttc" id="anamespacextb__local_html_a6aafec43f9ac7235a5dfd2c36ed1f56b"><div class="ttname"><a href="namespacextb__local.html#a6aafec43f9ac7235a5dfd2c36ed1f56b">xtb_local::local</a></div><div class="ttdeci">subroutine local(nat, at, nbf, nao, ihomo, xyz, z, focc, s, p, cmo, eig, q, etot, gbsa, basis)</div><div class="ttdef"><b>Definition:</b> <a href="local_8f90_source.html#l00020">local.f90:21</a></div></div>
<div class="ttc" id="anamespacextb__mctc__accuracy_html"><div class="ttname"><a href="namespacextb__mctc__accuracy.html">xtb_mctc_accuracy</a></div><div class="ttdoc">Numerical storage size parameters.</div><div class="ttdef"><b>Definition:</b> <a href="accuracy_8f90_source.html#l00019">accuracy.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__mctc__accuracy_html_a8bb85237162b62dd2297a6ec2b11d954"><div class="ttname"><a href="namespacextb__mctc__accuracy.html#a8bb85237162b62dd2297a6ec2b11d954">xtb_mctc_accuracy::wp</a></div><div class="ttdeci">integer, parameter wp</div><div class="ttdoc">Wanted precision.</div><div class="ttdef"><b>Definition:</b> <a href="accuracy_8f90_source.html#l00031">accuracy.f90:31</a></div></div>
<div class="ttc" id="anamespacextb__mctc__blas_html"><div class="ttname"><a href="namespacextb__mctc__blas.html">xtb_mctc_blas</a></div><div class="ttdoc">Interfaces to BLAS.</div><div class="ttdef"><b>Definition:</b> <a href="blas_8f90_source.html#l00019">blas.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__mctc__convert_html"><div class="ttname"><a href="namespacextb__mctc__convert.html">xtb_mctc_convert</a></div><div class="ttdef"><b>Definition:</b> <a href="convert_8f90_source.html#l00018">convert.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__mctc__convert_html_a251a6230289b71aefe9a11d7df95213a"><div class="ttname"><a href="namespacextb__mctc__convert.html#a251a6230289b71aefe9a11d7df95213a">xtb_mctc_convert::autoev</a></div><div class="ttdeci">real(wp), parameter, public autoev</div><div class="ttdef"><b>Definition:</b> <a href="convert_8f90_source.html#l00027">convert.f90:27</a></div></div>
<div class="ttc" id="anamespacextb__mctc__convert_html_acdf2e027ee943efa9cc9a6b4701e3810"><div class="ttname"><a href="namespacextb__mctc__convert.html#acdf2e027ee943efa9cc9a6b4701e3810">xtb_mctc_convert::evtoau</a></div><div class="ttdeci">real(wp), parameter, public evtoau</div><div class="ttdef"><b>Definition:</b> <a href="convert_8f90_source.html#l00028">convert.f90:28</a></div></div>
<div class="ttc" id="anamespacextb__mctc__lapack__eigensolve_html"><div class="ttname"><a href="namespacextb__mctc__lapack__eigensolve.html">xtb_mctc_lapack_eigensolve</a></div><div class="ttdoc">Wrapper for eigensolver routines.</div><div class="ttdef"><b>Definition:</b> <a href="eigensolve_8F90_source.html#l00020">eigensolve.F90:20</a></div></div>
<div class="ttc" id="anamespacextb__paramset_html"><div class="ttname"><a href="namespacextb__paramset.html">xtb_paramset</a></div><div class="ttdef"><b>Definition:</b> <a href="gfn__paramset_8f90_source.html#l00018">gfn_paramset.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__paramset_html_a778d90934065b54ef79ded14000a3c6b"><div class="ttname"><a href="namespacextb__paramset.html#a778d90934065b54ef79ded14000a3c6b">xtb_paramset::tmmetal</a></div><div class="ttdeci">integer function tmmetal(i)</div><div class="ttdef"><b>Definition:</b> <a href="gfn__paramset_8f90_source.html#l00137">gfn_paramset.f90:138</a></div></div>
<div class="ttc" id="anamespacextb__readin_html"><div class="ttname"><a href="namespacextb__readin.html">xtb_readin</a></div><div class="ttdef"><b>Definition:</b> <a href="readin_8f90_source.html#l00018">readin.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__readin_html_a3f2a0a4ba8d18c910b3a058712e42867"><div class="ttname"><a href="namespacextb__readin.html#a3f2a0a4ba8d18c910b3a058712e42867">xtb_readin::bool2string</a></div><div class="ttdeci">pure character(len=:) function, allocatable bool2string(bool)</div><div class="ttdef"><b>Definition:</b> <a href="readin_8f90_source.html#l00263">readin.f90:264</a></div></div>
<div class="ttc" id="anamespacextb__scc__core_html"><div class="ttname"><a href="namespacextb__scc__core.html">xtb_scc_core</a></div><div class="ttdoc">general functions for core functionalities of the SCC</div><div class="ttdef"><b>Definition:</b> <a href="scc__core_8f90_source.html#l00019">scc_core.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__scc__core_html_a2cc45bad34d8ad8fc414f3a2929c4d54"><div class="ttname"><a href="namespacextb__scc__core.html#a2cc45bad34d8ad8fc414f3a2929c4d54">xtb_scc_core::get_wiberg</a></div><div class="ttdeci">subroutine, public get_wiberg(n, ndim, at, xyz, P, S, wb, fila2)</div><div class="ttdef"><b>Definition:</b> <a href="scc__core_8f90_source.html#l01159">scc_core.f90:1160</a></div></div>
<div class="ttc" id="anamespacextb__scc__core_html_a3e0e142b640924088ca8b0ab266dd5e0"><div class="ttname"><a href="namespacextb__scc__core.html#a3e0e142b640924088ca8b0ab266dd5e0">xtb_scc_core::scc</a></div><div class="ttdeci">subroutine, public scc(env, xtbData, solver, n, nel, nopen, ndim, ndp, nqp, nmat, nshell, at, matlist, mdlst, mqlst, aoat2, ao2sh, ash, q, dipm, qp, qq, qlmom, qsh, zsh, xyz, aes, cm5, cm5a, gborn, solvation, scD4, broy, broydamp, damp0, pcem, shellShift, externShift, et, focc, focca, foccb, efa, efb, eel, ees, eaes, epol, ed, epcem, egap, emo, ihomo, ihomoa, ihomob, H0, H, S, dpint, qpint, X, P, ies, maxiter, startpdiag, scfconv, qconv, minpr, pr, fail, jter)</div><div class="ttdoc">self consistent charge iterator</div><div class="ttdef"><b>Definition:</b> <a href="scc__core_8f90_source.html#l00229">scc_core.f90:243</a></div></div>
<div class="ttc" id="anamespacextb__scc__core_html_a59b1e6be65cf0c0bf82cae50bf40000c"><div class="ttname"><a href="namespacextb__scc__core.html#a59b1e6be65cf0c0bf82cae50bf40000c">xtb_scc_core::qsh2qat</a></div><div class="ttdeci">subroutine, public qsh2qat(ash, qsh, qat)</div><div class="ttdef"><b>Definition:</b> <a href="scc__core_8f90_source.html#l01329">scc_core.f90:1330</a></div></div>
<div class="ttc" id="anamespacextb__scc__core_html_a83c6524ce5e445bf77857b79c238a8ff"><div class="ttname"><a href="namespacextb__scc__core.html#a83c6524ce5e445bf77857b79c238a8ff">xtb_scc_core::setzshell</a></div><div class="ttdeci">subroutine, public setzshell(xtbData, n, at, nshell, z, zsh, e, gfn_method)</div><div class="ttdef"><b>Definition:</b> <a href="scc__core_8f90_source.html#l01406">scc_core.f90:1407</a></div></div>
<div class="ttc" id="anamespacextb__scc__core_html_aac06c643c8cf37ba0337ace78508ab19"><div class="ttname"><a href="namespacextb__scc__core.html#aac06c643c8cf37ba0337ace78508ab19">xtb_scc_core::occu</a></div><div class="ttdeci">subroutine, public occu(ndim, nel, nopen, ihomoa, ihomob, focca, foccb)</div><div class="ttdef"><b>Definition:</b> <a href="scc__core_8f90_source.html#l01063">scc_core.f90:1064</a></div></div>
<div class="ttc" id="anamespacextb__scc__core_html_af5c3cd803d403c23fc0ae9c2eb1229c6"><div class="ttname"><a href="namespacextb__scc__core.html#af5c3cd803d403c23fc0ae9c2eb1229c6">xtb_scc_core::dmat</a></div><div class="ttdeci">subroutine, public dmat(ndim, focc, C, P)</div><div class="ttdoc">density matrix</div><div class="ttdef"><b>Definition:</b> <a href="scc__core_8f90_source.html#l01128">scc_core.f90:1129</a></div></div>
<div class="ttc" id="anamespacextb__scf_html"><div class="ttname"><a href="namespacextb__scf.html">xtb_scf</a></div><div class="ttdef"><b>Definition:</b> <a href="scf__module_8F90_source.html#l00018">scf_module.F90:18</a></div></div>
<div class="ttc" id="anamespacextb__scf_html_a7390c40a38032c3d210c39edecfa49ed"><div class="ttname"><a href="namespacextb__scf.html#a7390c40a38032c3d210c39edecfa49ed">xtb_scf::scf</a></div><div class="ttdeci">subroutine, public scf(env, mol, wfn, basis, pcem, xtbData, solvation, egap, et, maxiter, prlevel, restart, grd, acc, energy, gradient, res)</div><div class="ttdef"><b>Definition:</b> <a href="scf__module_8F90_source.html#l00073">scf_module.F90:75</a></div></div>
<div class="ttc" id="anamespacextb__scf_html_a9048f62175ef09496bdf38170872632b"><div class="ttname"><a href="namespacextb__scf.html#a9048f62175ef09496bdf38170872632b">xtb_scf::profile</a></div><div class="ttdeci">logical, parameter profile</div><div class="ttdef"><b>Definition:</b> <a href="scf__module_8F90_source.html#l00060">scf_module.F90:60</a></div></div>
<div class="ttc" id="anamespacextb__scf_html_aea2b7ba8bdd6ff29e75c5c3008c3ea20"><div class="ttname"><a href="namespacextb__scf.html#aea2b7ba8bdd6ff29e75c5c3008c3ea20">xtb_scf::early3d</a></div><div class="ttdeci">pure elemental logical function early3d(i)</div><div class="ttdef"><b>Definition:</b> <a href="scf__module_8F90_source.html#l00883">scf_module.F90:884</a></div></div>
<div class="ttc" id="anamespacextb__scf_html_afbb45fadd33b4d004619a75ddf69e0f9"><div class="ttname"><a href="namespacextb__scf.html#afbb45fadd33b4d004619a75ddf69e0f9">xtb_scf::xbond</a></div><div class="ttdeci">pure elemental logical function xbond(ati, atj)</div><div class="ttdoc">X..Y bond? (X=halogen but not F, Y=N,O,P,S) !CB: Cl is formally included, but.</div><div class="ttdef"><b>Definition:</b> <a href="scf__module_8F90_source.html#l00894">scf_module.F90:895</a></div></div>
<div class="ttc" id="anamespacextb__scf_html_afe99c4bdc76f3ccf7baa013bb17b05ac"><div class="ttname"><a href="namespacextb__scf.html#afe99c4bdc76f3ccf7baa013bb17b05ac">xtb_scf::metal</a></div><div class="ttdeci">integer, dimension(1:86), parameter metal</div><div class="ttdef"><b>Definition:</b> <a href="scf__module_8F90_source.html#l00064">scf_module.F90:64</a></div></div>
<div class="ttc" id="anamespacextb__setparam_html"><div class="ttname"><a href="namespacextb__setparam.html">xtb_setparam</a></div><div class="ttdef"><b>Definition:</b> <a href="setparam_8f90_source.html#l00022">setparam.f90:22</a></div></div>
<div class="ttc" id="anamespacextb__setparam_html_ab9325abbf76b443fcbcea253cbbcb713"><div class="ttname"><a href="namespacextb__setparam.html#ab9325abbf76b443fcbcea253cbbcb713">xtb_setparam::pr_eig</a></div><div class="ttdeci">logical pr_eig</div><div class="ttdef"><b>Definition:</b> <a href="setparam_8f90_source.html#l00271">setparam.f90:271</a></div></div>
<div class="ttc" id="anamespacextb__setparam_html_ad9bb2e1e26c88868fd69cdcf78c7662c"><div class="ttname"><a href="namespacextb__setparam.html#ad9bb2e1e26c88868fd69cdcf78c7662c">xtb_setparam::broydamp</a></div><div class="ttdeci">real(wp) broydamp</div><div class="ttdef"><b>Definition:</b> <a href="setparam_8f90_source.html#l00072">setparam.f90:72</a></div></div>
<div class="ttc" id="anamespacextb__setparam_html_ae4ed97406117d0e94497eb8b62af5533"><div class="ttname"><a href="namespacextb__setparam.html#ae4ed97406117d0e94497eb8b62af5533">xtb_setparam::pr_lmo</a></div><div class="ttdeci">logical pr_lmo</div><div class="ttdef"><b>Definition:</b> <a href="setparam_8f90_source.html#l00260">setparam.f90:260</a></div></div>
<div class="ttc" id="anamespacextb__solv__cm5_html"><div class="ttname"><a href="namespacextb__solv__cm5.html">xtb_solv_cm5</a></div><div class="ttdef"><b>Definition:</b> <a href="cm5_8f90_source.html#l00021">cm5.f90:21</a></div></div>
<div class="ttc" id="anamespacextb__solv__cm5_html_a248c448671b487e7115213f001579585"><div class="ttname"><a href="namespacextb__solv__cm5.html#a248c448671b487e7115213f001579585">xtb_solv_cm5::calc_cm5</a></div><div class="ttdeci">subroutine calc_cm5(nat, at, xyz, cm5, dcm5dr)</div><div class="ttdef"><b>Definition:</b> <a href="cm5_8f90_source.html#l00024">cm5.f90:25</a></div></div>
<div class="ttc" id="anamespacextb__solv__gbsa_html"><div class="ttname"><a href="namespacextb__solv__gbsa.html">xtb_solv_gbsa</a></div><div class="ttdoc">Implementation for generalized Born and related solvation models.</div><div class="ttdef"><b>Definition:</b> <a href="gbsa_8f90_source.html#l00019">gbsa.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__type__basisset_html"><div class="ttname"><a href="namespacextb__type__basisset.html">xtb_type_basisset</a></div><div class="ttdef"><b>Definition:</b> <a href="type_2basisset_8f90_source.html#l00018">basisset.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__type__coulomb_html"><div class="ttname"><a href="namespacextb__type__coulomb.html">xtb_type_coulomb</a></div><div class="ttdoc">Implementation of coulombic interaction evaluator.</div><div class="ttdef"><b>Definition:</b> <a href="src_2type_2coulomb_8f90_source.html#l00022">coulomb.f90:22</a></div></div>
<div class="ttc" id="anamespacextb__type__data_html"><div class="ttname"><a href="namespacextb__type__data.html">xtb_type_data</a></div><div class="ttdef"><b>Definition:</b> <a href="type_2data_8f90_source.html#l00018">data.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__type__environment_html"><div class="ttname"><a href="namespacextb__type__environment.html">xtb_type_environment</a></div><div class="ttdoc">Calculation environment.</div><div class="ttdef"><b>Definition:</b> <a href="type_2environment_8f90_source.html#l00019">environment.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__type__latticepoint_html"><div class="ttname"><a href="namespacextb__type__latticepoint.html">xtb_type_latticepoint</a></div><div class="ttdoc">Generator for lattice points.</div><div class="ttdef"><b>Definition:</b> <a href="src_2type_2latticepoint_8f90_source.html#l00019">latticepoint.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__type__molecule_html"><div class="ttname"><a href="namespacextb__type__molecule.html">xtb_type_molecule</a></div><div class="ttdoc">molecular structure information</div><div class="ttdef"><b>Definition:</b> <a href="type_2molecule_8f90_source.html#l00034">molecule.f90:34</a></div></div>
<div class="ttc" id="anamespacextb__type__param_html"><div class="ttname"><a href="namespacextb__type__param.html">xtb_type_param</a></div><div class="ttdef"><b>Definition:</b> <a href="param_8f90_source.html#l00018">param.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__type__pcem_html"><div class="ttname"><a href="namespacextb__type__pcem.html">xtb_type_pcem</a></div><div class="ttdef"><b>Definition:</b> <a href="pcem_8f90_source.html#l00018">pcem.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__type__solvation_html"><div class="ttname"><a href="namespacextb__type__solvation.html">xtb_type_solvation</a></div><div class="ttdoc">Abstract solvation model.</div><div class="ttdef"><b>Definition:</b> <a href="solvation_8f90_source.html#l00019">solvation.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__type__timer_html"><div class="ttname"><a href="namespacextb__type__timer.html">xtb_type_timer</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8f90_source.html#l00018">timer.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__type__timer_html_a1dcf014087e66f68529af68ba3ab41b0"><div class="ttname"><a href="namespacextb__type__timer.html#a1dcf014087e66f68529af68ba3ab41b0">xtb_type_timer::timer</a></div><div class="ttdeci">subroutine timer(self, i, inmsg)</div><div class="ttdef"><b>Definition:</b> <a href="timer_8f90_source.html#l00216">timer.f90:217</a></div></div>
<div class="ttc" id="anamespacextb__type__wavefunction_html"><div class="ttname"><a href="namespacextb__type__wavefunction.html">xtb_type_wavefunction</a></div><div class="ttdef"><b>Definition:</b> <a href="wavefunction_8f90_source.html#l00018">wavefunction.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__xtb__coulomb_html"><div class="ttname"><a href="namespacextb__xtb__coulomb.html">xtb_xtb_coulomb</a></div><div class="ttdoc">Implementation of an isotropic electrostatics container.</div><div class="ttdef"><b>Definition:</b> <a href="src_2xtb_2coulomb_8f90_source.html#l00019">coulomb.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__xtb__data_html"><div class="ttname"><a href="namespacextb__xtb__data.html">xtb_xtb_data</a></div><div class="ttdoc">Parametrisation data for xTB methods.</div><div class="ttdef"><b>Definition:</b> <a href="xtb_2data_8f90_source.html#l00019">data.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__xtb__dispersion_html"><div class="ttname"><a href="namespacextb__xtb__dispersion.html">xtb_xtb_dispersion</a></div><div class="ttdoc">Self-consistent dispersion energy.</div><div class="ttdef"><b>Definition:</b> <a href="dispersion_8f90_source.html#l00019">dispersion.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__xtb__halogen_html"><div class="ttname"><a href="namespacextb__xtb__halogen.html">xtb_xtb_halogen</a></div><div class="ttdoc">TODO.</div><div class="ttdef"><b>Definition:</b> <a href="halogen_8f90_source.html#l00019">halogen.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__xtb__halogen_html_a56fea9732619a8800ea9c33900991c68"><div class="ttname"><a href="namespacextb__xtb__halogen.html#a56fea9732619a8800ea9c33900991c68">xtb_xtb_halogen::xbpot</a></div><div class="ttdeci">subroutine, public xbpot(halData, n, at, xyz, xblist, nxb, a, exb, g)</div><div class="ttdef"><b>Definition:</b> <a href="halogen_8f90_source.html#l00033">halogen.f90:34</a></div></div>
<div class="ttc" id="anamespacextb__xtb__hamiltonian__gpu_html"><div class="ttname"><a href="namespacextb__xtb__hamiltonian__gpu.html">xtb_xtb_hamiltonian_gpu</a></div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian__gpu_8f90_source.html#l00018">hamiltonian_gpu.f90:18</a></div></div>
<div class="ttc" id="anamespacextb__xtb__hamiltonian__gpu_html_a3fc32a40afb82002170a6633d8870ddb"><div class="ttname"><a href="namespacextb__xtb__hamiltonian__gpu.html#a3fc32a40afb82002170a6633d8870ddb">xtb_xtb_hamiltonian_gpu::build_dsdqh0_gpu</a></div><div class="ttdeci">subroutine, public build_dsdqh0_gpu(nShell, hData, selfEnergy, dSEdcn, intcut, nat, nao, nbf, at, xyz, trans, caoshell, saoshell, nprim, primcount, alp, cont, p, Pew, ves, vs, vd, vq, dhdcn, g, sigma)</div><div class="ttdoc">Computes the gradient of the dipole/qpole integral contribution.</div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian__gpu_8f90_source.html#l00771">hamiltonian_gpu.f90:774</a></div></div>
<div class="ttc" id="anamespacextb__xtb__hamiltonian__gpu_html_aee3ffc022ae0b9686cef17ce77e6b117"><div class="ttname"><a href="namespacextb__xtb__hamiltonian__gpu.html#aee3ffc022ae0b9686cef17ce77e6b117">xtb_xtb_hamiltonian_gpu::build_sdqh0_gpu</a></div><div class="ttdeci">subroutine, public build_sdqh0_gpu(nShell, hData, nat, at, nbf, nao, xyz, trans, selfEnergy, intcut, caoshell, saoshell, nprim, primcount, alp, cont, sint, dpint, qpint, H0)</div><div class="ttdoc">Computes the dipole and quadrupole integrals and performs screening to.</div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian__gpu_8f90_source.html#l00199">hamiltonian_gpu.f90:202</a></div></div>
<div class="ttc" id="anamespacextb__xtb__hamiltonian_html"><div class="ttname"><a href="namespacextb__xtb__hamiltonian.html">xtb_xtb_hamiltonian</a></div><div class="ttdoc">Implementation of the xTB core Hamiltonian.</div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian_8f90_source.html#l00019">hamiltonian.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__xtb__hamiltonian_html_a299eaa3877160d0aff3f63dc55b12fde"><div class="ttname"><a href="namespacextb__xtb__hamiltonian.html#a299eaa3877160d0aff3f63dc55b12fde">xtb_xtb_hamiltonian::build_dsdqh0_noreset</a></div><div class="ttdeci">subroutine, public build_dsdqh0_noreset(nShell, hData, selfEnergy, dSEdcn, intcut, nat, nao, nbf, at, xyz, caoshell, saoshell, nprim, primcount, alp, cont, H0, S, p, Pew, ves, vs, vd, vq, dhdcn, g, sigma)</div><div class="ttdoc">Computes the gradient of the dipole/qpole integral contribution.</div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian_8f90_source.html#l00563">hamiltonian.f90:566</a></div></div>
<div class="ttc" id="anamespacextb__xtb__hamiltonian_html_a452ff391a1572caaeec2ca34bca16bc8"><div class="ttname"><a href="namespacextb__xtb__hamiltonian.html#a452ff391a1572caaeec2ca34bca16bc8">xtb_xtb_hamiltonian::count_dpint</a></div><div class="ttdeci">subroutine, public count_dpint(ndp, dpint, thr)</div><div class="ttdoc">Count number of significant dipole integrals.</div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian_8f90_source.html#l00756">hamiltonian.f90:757</a></div></div>
<div class="ttc" id="anamespacextb__xtb__hamiltonian_html_a8364d9293f8dac8d5de89c5186f7effc"><div class="ttname"><a href="namespacextb__xtb__hamiltonian.html#a8364d9293f8dac8d5de89c5186f7effc">xtb_xtb_hamiltonian::build_dsdqh0</a></div><div class="ttdeci">subroutine, public build_dsdqh0(nShell, hData, selfEnergy, dSEdcn, intcut, nat, nao, nbf, at, xyz, trans, caoshell, saoshell, nprim, primcount, alp, cont, p, Pew, ves, vs, vd, vq, dhdcn, g, sigma)</div><div class="ttdoc">Computes the gradient of the dipole/qpole integral contribution.</div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian_8f90_source.html#l00361">hamiltonian.f90:364</a></div></div>
<div class="ttc" id="anamespacextb__xtb__hamiltonian_html_a9f0d8be35a4ef0f2dbbbafd2ef873d64"><div class="ttname"><a href="namespacextb__xtb__hamiltonian.html#a9f0d8be35a4ef0f2dbbbafd2ef873d64">xtb_xtb_hamiltonian::build_sdqh0</a></div><div class="ttdeci">subroutine, public build_sdqh0(nShell, hData, nat, at, nbf, nao, xyz, trans, selfEnergy, intcut, caoshell, saoshell, nprim, primcount, alp, cont, sint, dpint, qpint, H0)</div><div class="ttdoc">Computes the dipole and quadrupole integrals and performs screening to.</div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian_8f90_source.html#l00146">hamiltonian.f90:149</a></div></div>
<div class="ttc" id="anamespacextb__xtb__hamiltonian_html_acea5bedffd7dfd433b664c7729cdd3b2"><div class="ttname"><a href="namespacextb__xtb__hamiltonian.html#acea5bedffd7dfd433b664c7729cdd3b2">xtb_xtb_hamiltonian::count_qpint</a></div><div class="ttdeci">subroutine, public count_qpint(nqp, qpint, thr)</div><div class="ttdoc">Count number of significant quadrupole integrals.</div><div class="ttdef"><b>Definition:</b> <a href="hamiltonian_8f90_source.html#l00784">hamiltonian.f90:785</a></div></div>
<div class="ttc" id="anamespacextb__xtb__multipole_html"><div class="ttname"><a href="namespacextb__xtb__multipole.html">xtb_xtb_multipole</a></div><div class="ttdoc">TODO.</div><div class="ttdef"><b>Definition:</b> <a href="multipole_8f90_source.html#l00019">multipole.f90:19</a></div></div>
<div class="ttc" id="anamespacextb__xtb__repulsion_html"><div class="ttname"><a href="namespacextb__xtb__repulsion.html">xtb_xtb_repulsion</a></div><div class="ttdoc">Implementation of the repulsion energy used in the xTB Hamiltonian.</div><div class="ttdef"><b>Definition:</b> <a href="repulsion_8F90_source.html#l00019">repulsion.F90:19</a></div></div>
<div class="ttc" id="aproperty_8F90_html_a6592073970291ef51906258c283114fd"><div class="ttname"><a href="property_8F90.html#a6592073970291ef51906258c283114fd">print_orbital_eigenvalues</a></div><div class="ttdeci">subroutine print_orbital_eigenvalues(iunit, wfn, range)</div><div class="ttdef"><b>Definition:</b> <a href="property_8F90_source.html#l01270">property.F90:1271</a></div></div>
<div class="ttc" id="astructxtb__coulomb__klopmanohno_1_1tklopmanohno_html"><div class="ttname"><a href="structxtb__coulomb__klopmanohno_1_1tklopmanohno.html">xtb_coulomb_klopmanohno::tklopmanohno</a></div><div class="ttdef"><b>Definition:</b> <a href="klopmanohno_8f90_source.html#l00055">klopmanohno.f90:55</a></div></div>
<div class="ttc" id="astructxtb__mctc__lapack__eigensolve_1_1teigensolver_html"><div class="ttname"><a href="structxtb__mctc__lapack__eigensolve_1_1teigensolver.html">xtb_mctc_lapack_eigensolve::teigensolver</a></div><div class="ttdef"><b>Definition:</b> <a href="eigensolve_8F90_source.html#l00035">eigensolve.F90:35</a></div></div>
<div class="ttc" id="astructxtb__solv__gbsa_1_1tborn_html"><div class="ttname"><a href="structxtb__solv__gbsa_1_1tborn.html">xtb_solv_gbsa::tborn</a></div><div class="ttdef"><b>Definition:</b> <a href="gbsa_8f90_source.html#l00044">gbsa.f90:44</a></div></div>
<div class="ttc" id="astructxtb__type__basisset_1_1tbasisset_html"><div class="ttname"><a href="structxtb__type__basisset_1_1tbasisset.html">xtb_type_basisset::tbasisset</a></div><div class="ttdef"><b>Definition:</b> <a href="type_2basisset_8f90_source.html#l00026">basisset.f90:26</a></div></div>
<div class="ttc" id="astructxtb__type__coulomb_1_1tcoulomb_html"><div class="ttname"><a href="structxtb__type__coulomb_1_1tcoulomb.html">xtb_type_coulomb::tcoulomb</a></div><div class="ttdoc">Base point charge electrostatics evaluator.</div><div class="ttdef"><b>Definition:</b> <a href="src_2type_2coulomb_8f90_source.html#l00040">coulomb.f90:40</a></div></div>
<div class="ttc" id="astructxtb__type__data_1_1scc__results_html"><div class="ttname"><a href="structxtb__type__data_1_1scc__results.html">xtb_type_data::scc_results</a></div><div class="ttdef"><b>Definition:</b> <a href="type_2data_8f90_source.html#l00028">data.f90:28</a></div></div>
<div class="ttc" id="astructxtb__type__environment_1_1tenvironment_html"><div class="ttname"><a href="structxtb__type__environment_1_1tenvironment.html">xtb_type_environment::tenvironment</a></div><div class="ttdoc">Calculation environment.</div><div class="ttdef"><b>Definition:</b> <a href="type_2environment_8f90_source.html#l00038">environment.f90:38</a></div></div>
<div class="ttc" id="astructxtb__type__latticepoint_1_1tlatticepoint_html"><div class="ttname"><a href="structxtb__type__latticepoint_1_1tlatticepoint.html">xtb_type_latticepoint::tlatticepoint</a></div><div class="ttdoc">Lattice point generator.</div><div class="ttdef"><b>Definition:</b> <a href="src_2type_2latticepoint_8f90_source.html#l00035">latticepoint.f90:35</a></div></div>
<div class="ttc" id="astructxtb__type__molecule_1_1tmolecule_html"><div class="ttname"><a href="structxtb__type__molecule_1_1tmolecule.html">xtb_type_molecule::tmolecule</a></div><div class="ttdoc">Molecular structure information.</div><div class="ttdef"><b>Definition:</b> <a href="type_2molecule_8f90_source.html#l00052">molecule.f90:52</a></div></div>
<div class="ttc" id="astructxtb__type__pcem_1_1tb__pcem_html"><div class="ttname"><a href="structxtb__type__pcem_1_1tb__pcem.html">xtb_type_pcem::tb_pcem</a></div><div class="ttdef"><b>Definition:</b> <a href="pcem_8f90_source.html#l00025">pcem.f90:25</a></div></div>
<div class="ttc" id="astructxtb__type__solvation_1_1tsolvation_html"><div class="ttname"><a href="structxtb__type__solvation_1_1tsolvation.html">xtb_type_solvation::tsolvation</a></div><div class="ttdef"><b>Definition:</b> <a href="solvation_8f90_source.html#l00028">solvation.f90:28</a></div></div>
<div class="ttc" id="astructxtb__type__timer_1_1tb__timer_html"><div class="ttname"><a href="structxtb__type__timer_1_1tb__timer.html">xtb_type_timer::tb_timer</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8f90_source.html#l00025">timer.f90:25</a></div></div>
<div class="ttc" id="astructxtb__type__wavefunction_1_1twavefunction_html"><div class="ttname"><a href="structxtb__type__wavefunction_1_1twavefunction.html">xtb_type_wavefunction::twavefunction</a></div><div class="ttdef"><b>Definition:</b> <a href="wavefunction_8f90_source.html#l00026">wavefunction.f90:26</a></div></div>
<div class="ttc" id="astructxtb__xtb__coulomb_1_1txtbcoulomb_html"><div class="ttname"><a href="structxtb__xtb__coulomb_1_1txtbcoulomb.html">xtb_xtb_coulomb::txtbcoulomb</a></div><div class="ttdoc">Isotropic electrostatics.</div><div class="ttdef"><b>Definition:</b> <a href="src_2xtb_2coulomb_8f90_source.html#l00031">coulomb.f90:31</a></div></div>
<div class="ttc" id="astructxtb__xtb__data_1_1txtbdata_html"><div class="ttname"><a href="structxtb__xtb__data_1_1txtbdata.html">xtb_xtb_data::txtbdata</a></div><div class="ttdoc">Parametrisation data for the xTB method.</div><div class="ttdef"><b>Definition:</b> <a href="xtb_2data_8f90_source.html#l00273">data.f90:273</a></div></div>
<div class="ttc" id="astructxtb__xtb__dispersion_1_1txtbdispersion_html"><div class="ttname"><a href="structxtb__xtb__dispersion_1_1txtbdispersion.html">xtb_xtb_dispersion::txtbdispersion</a></div><div class="ttdef"><b>Definition:</b> <a href="dispersion_8f90_source.html#l00032">dispersion.f90:32</a></div></div>
<div class="ttc" id="astructxtb__xtb__multipole_1_1txtbmultipole_html"><div class="ttname"><a href="structxtb__xtb__multipole_1_1txtbmultipole.html">xtb_xtb_multipole::txtbmultipole</a></div><div class="ttdef"><b>Definition:</b> <a href="multipole_8f90_source.html#l00028">multipole.f90:28</a></div></div>
<div class="ttc" id="asymmetry__i_8c_html_aa77c823a9fc018ae1d437369708d8727"><div class="ttname"><a href="symmetry__i_8c.html#aa77c823a9fc018ae1d437369708d8727">true</a></div><div class="ttdeci">int true(void)</div><div class="ttdef"><b>Definition:</b> <a href="symmetry__i_8c_source.html#l00132">symmetry_i.c:132</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 29 2021 07:14:27 for My Project by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
